<!DOCTYPE html>
<html lang="en-US">
<head><meta charset="UTF-8" /><script type="73c9f148f6d44e5e000b4ea0-text/javascript">if(navigator.userAgent.match(/MSIE|Internet Explorer/i)||navigator.userAgent.match(/Trident\/7\..*?rv:11/i)){var href=document.location.href;if(!href.match(/[?&]nowprocket/)){if(href.indexOf("?")==-1){if(href.indexOf("#")==-1){document.location.href=href+"?nowprocket=1"}else{document.location.href=href.replace("#","?nowprocket=1#")}}else{if(href.indexOf("#")==-1){document.location.href=href+"&nowprocket=1"}else{document.location.href=href.replace("#","&nowprocket=1#")}}}}</script><script type="73c9f148f6d44e5e000b4ea0-text/javascript">class RocketLazyLoadScripts{constructor(){this.v="1.2.3",this.triggerEvents=["keydown","mousedown","mousemove","touchmove","touchstart","touchend","wheel"],this.userEventHandler=this._triggerListener.bind(this),this.touchStartHandler=this._onTouchStart.bind(this),this.touchMoveHandler=this._onTouchMove.bind(this),this.touchEndHandler=this._onTouchEnd.bind(this),this.clickHandler=this._onClick.bind(this),this.interceptedClicks=[],window.addEventListener("pageshow",t=>{this.persisted=t.persisted}),window.addEventListener("DOMContentLoaded",()=>{this._preconnect3rdParties()}),this.delayedScripts={normal:[],async:[],defer:[]},this.trash=[],this.allJQueries=[]}_addUserInteractionListener(t){if(document.hidden){t._triggerListener();return}this.triggerEvents.forEach(e=>window.addEventListener(e,t.userEventHandler,{passive:!0})),window.addEventListener("touchstart",t.touchStartHandler,{passive:!0}),window.addEventListener("mousedown",t.touchStartHandler),document.addEventListener("visibilitychange",t.userEventHandler)}_removeUserInteractionListener(){this.triggerEvents.forEach(t=>window.removeEventListener(t,this.userEventHandler,{passive:!0})),document.removeEventListener("visibilitychange",this.userEventHandler)}_onTouchStart(t){"HTML"!==t.target.tagName&&(window.addEventListener("touchend",this.touchEndHandler),window.addEventListener("mouseup",this.touchEndHandler),window.addEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.addEventListener("mousemove",this.touchMoveHandler),t.target.addEventListener("click",this.clickHandler),this._renameDOMAttribute(t.target,"onclick","rocket-onclick"),this._pendingClickStarted())}_onTouchMove(t){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler),t.target.removeEventListener("click",this.clickHandler),this._renameDOMAttribute(t.target,"rocket-onclick","onclick"),this._pendingClickFinished()}_onTouchEnd(t){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler)}_onClick(t){t.target.removeEventListener("click",this.clickHandler),this._renameDOMAttribute(t.target,"rocket-onclick","onclick"),this.interceptedClicks.push(t),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this._pendingClickFinished()}_replayClicks(){window.removeEventListener("touchstart",this.touchStartHandler,{passive:!0}),window.removeEventListener("mousedown",this.touchStartHandler),this.interceptedClicks.forEach(t=>{t.target.dispatchEvent(new MouseEvent("click",{view:t.view,bubbles:!0,cancelable:!0}))})}_waitForPendingClicks(){return new Promise(t=>{this._isClickPending?this._pendingClickFinished=t:t()})}_pendingClickStarted(){this._isClickPending=!0}_pendingClickFinished(){this._isClickPending=!1}_renameDOMAttribute(t,e,r){t.hasAttribute&&t.hasAttribute(e)&&(event.target.setAttribute(r,event.target.getAttribute(e)),event.target.removeAttribute(e))}_triggerListener(){this._removeUserInteractionListener(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this._loadEverythingNow.bind(this)):this._loadEverythingNow()}_preconnect3rdParties(){let t=[];document.querySelectorAll("script[type=rocketlazyloadscript]").forEach(e=>{if(e.hasAttribute("src")){let r=new URL(e.src).origin;r!==location.origin&&t.push({src:r,crossOrigin:e.crossOrigin||"module"===e.getAttribute("data-rocket-type")})}}),t=[...new Map(t.map(t=>[JSON.stringify(t),t])).values()],this._batchInjectResourceHints(t,"preconnect")}async _loadEverythingNow(){this.lastBreath=Date.now(),this._delayEventListeners(this),this._delayJQueryReady(this),this._handleDocumentWrite(),this._registerAllDelayedScripts(),this._preloadAllScripts(),await this._loadScriptsFromList(this.delayedScripts.normal),await this._loadScriptsFromList(this.delayedScripts.defer),await this._loadScriptsFromList(this.delayedScripts.async);try{await this._triggerDOMContentLoaded(),await this._triggerWindowLoad()}catch(t){console.error(t)}window.dispatchEvent(new Event("rocket-allScriptsLoaded")),this._waitForPendingClicks().then(()=>{this._replayClicks()}),this._emptyTrash()}_registerAllDelayedScripts(){document.querySelectorAll("script[type=rocketlazyloadscript]").forEach(t=>{t.hasAttribute("data-rocket-src")?t.hasAttribute("async")&&!1!==t.async?this.delayedScripts.async.push(t):t.hasAttribute("defer")&&!1!==t.defer||"module"===t.getAttribute("data-rocket-type")?this.delayedScripts.defer.push(t):this.delayedScripts.normal.push(t):this.delayedScripts.normal.push(t)})}async _transformScript(t){return new Promise((await this._littleBreath(),navigator.userAgent.indexOf("Firefox/")>0||""===navigator.vendor)?e=>{let r=document.createElement("script");[...t.attributes].forEach(t=>{let e=t.nodeName;"type"!==e&&("data-rocket-type"===e&&(e="type"),"data-rocket-src"===e&&(e="src"),r.setAttribute(e,t.nodeValue))}),t.text&&(r.text=t.text),r.hasAttribute("src")?(r.addEventListener("load",e),r.addEventListener("error",e)):(r.text=t.text,e());try{t.parentNode.replaceChild(r,t)}catch(i){e()}}:async e=>{function r(){t.setAttribute("data-rocket-status","failed"),e()}try{let i=t.getAttribute("data-rocket-type"),n=t.getAttribute("data-rocket-src");t.text,i?(t.type=i,t.removeAttribute("data-rocket-type")):t.removeAttribute("type"),t.addEventListener("load",function r(){t.setAttribute("data-rocket-status","executed"),e()}),t.addEventListener("error",r),n?(t.removeAttribute("data-rocket-src"),t.src=n):t.src="data:text/javascript;base64,"+window.btoa(unescape(encodeURIComponent(t.text)))}catch(s){r()}})}async _loadScriptsFromList(t){let e=t.shift();return e&&e.isConnected?(await this._transformScript(e),this._loadScriptsFromList(t)):Promise.resolve()}_preloadAllScripts(){this._batchInjectResourceHints([...this.delayedScripts.normal,...this.delayedScripts.defer,...this.delayedScripts.async],"preload")}_batchInjectResourceHints(t,e){var r=document.createDocumentFragment();t.forEach(t=>{let i=t.getAttribute&&t.getAttribute("data-rocket-src")||t.src;if(i){let n=document.createElement("link");n.href=i,n.rel=e,"preconnect"!==e&&(n.as="script"),t.getAttribute&&"module"===t.getAttribute("data-rocket-type")&&(n.crossOrigin=!0),t.crossOrigin&&(n.crossOrigin=t.crossOrigin),t.integrity&&(n.integrity=t.integrity),r.appendChild(n),this.trash.push(n)}}),document.head.appendChild(r)}_delayEventListeners(t){let e={};function r(t,r){!function t(r){!e[r]&&(e[r]={originalFunctions:{add:r.addEventListener,remove:r.removeEventListener},eventsToRewrite:[]},r.addEventListener=function(){arguments[0]=i(arguments[0]),e[r].originalFunctions.add.apply(r,arguments)},r.removeEventListener=function(){arguments[0]=i(arguments[0]),e[r].originalFunctions.remove.apply(r,arguments)});function i(t){return e[r].eventsToRewrite.indexOf(t)>=0?"rocket-"+t:t}}(t),e[t].eventsToRewrite.push(r)}function i(t,e){let r=t[e];Object.defineProperty(t,e,{get:()=>r||function(){},set(i){t["rocket"+e]=r=i}})}r(document,"DOMContentLoaded"),r(window,"DOMContentLoaded"),r(window,"load"),r(window,"pageshow"),r(document,"readystatechange"),i(document,"onreadystatechange"),i(window,"onload"),i(window,"onpageshow")}_delayJQueryReady(t){let e;function r(r){if(r&&r.fn&&!t.allJQueries.includes(r)){r.fn.ready=r.fn.init.prototype.ready=function(e){return t.domReadyFired?e.bind(document)(r):document.addEventListener("rocket-DOMContentLoaded",()=>e.bind(document)(r)),r([])};let i=r.fn.on;r.fn.on=r.fn.init.prototype.on=function(){if(this[0]===window){function t(t){return t.split(" ").map(t=>"load"===t||0===t.indexOf("load.")?"rocket-jquery-load":t).join(" ")}"string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=t(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach(e=>{let r=arguments[0][e];delete arguments[0][e],arguments[0][t(e)]=r})}return i.apply(this,arguments),this},t.allJQueries.push(r)}e=r}r(window.jQuery),Object.defineProperty(window,"jQuery",{get:()=>e,set(t){r(t)}})}async _triggerDOMContentLoaded(){this.domReadyFired=!0,await this._littleBreath(),document.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._littleBreath(),window.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._littleBreath(),document.dispatchEvent(new Event("rocket-readystatechange")),await this._littleBreath(),document.rocketonreadystatechange&&document.rocketonreadystatechange()}async _triggerWindowLoad(){await this._littleBreath(),window.dispatchEvent(new Event("rocket-load")),await this._littleBreath(),window.rocketonload&&window.rocketonload(),await this._littleBreath(),this.allJQueries.forEach(t=>t(window).trigger("rocket-jquery-load")),await this._littleBreath();let t=new Event("rocket-pageshow");t.persisted=this.persisted,window.dispatchEvent(t),await this._littleBreath(),window.rocketonpageshow&&window.rocketonpageshow({persisted:this.persisted})}_handleDocumentWrite(){let t=new Map;document.write=document.writeln=function(e){let r=document.currentScript;r||console.error("WPRocket unable to document.write this: "+e);let i=document.createRange(),n=r.parentElement,s=t.get(r);void 0===s&&(s=r.nextSibling,t.set(r,s));let a=document.createDocumentFragment();i.setStart(a,0),a.appendChild(i.createContextualFragment(e)),n.insertBefore(a,s)}}async _littleBreath(){Date.now()-this.lastBreath>45&&(await this._requestAnimFrame(),this.lastBreath=Date.now())}async _requestAnimFrame(){return document.hidden?new Promise(t=>setTimeout(t)):new Promise(t=>requestAnimationFrame(t))}_emptyTrash(){this.trash.forEach(t=>t.remove())}static run(){let t=new RocketLazyLoadScripts;t._addUserInteractionListener(t)}}RocketLazyLoadScripts.run();</script>
<title>How to Grid Search Hyperparameters for PyTorch Models - MachineLearningMastery.com</title>
<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin><link rel="stylesheet" href="https://machinelearningmastery.com/wp-content/cache/min/1/30405a461b20973b25df19a247d17397.css" media="all" data-minify="1" />
<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php" />
<script type="rocketlazyloadscript">!function(){"use strict";var t=window.location.search.substring(1).split("&");const e=t=>t.replace(/\s/g,""),n=t=>new Promise(e=>{if(!("msCrypto"in window)&&"https:"===location.protocol&&"crypto"in window&&"TextEncoder"in window){const n=(new TextEncoder).encode(t);crypto.subtle.digest("SHA-256",n).then(t=>{const n=Array.from(new Uint8Array(t)).map(t=>("00"+t.toString(16)).slice(-2)).join("");e(n)})}else e("")});for(var o=0;o<t.length;o++){var i="adt_ei",r=t[o];if(0===r.indexOf(i)){var s=r.split(i+"=")[1];if((t=>{const e=t.match(/((?=([a-zA-Z0-9._!#$%+^&*()[\]<>-]+))\2@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);return e?e[0]:""})(e(s.toLowerCase()))){n(s).then(e=>{e.length&&(localStorage.setItem(i,e),t.splice(o,1),history.replaceState(null,"","?"+t.join("&")))});break}}}}();
</script><meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<script type="rocketlazyloadscript">
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>
<style data-no-optimize="1" data-cfasync="false">
	.adthrive-ad {
		margin-top: 10px;
		margin-bottom: 10px;
		text-align: center;
		overflow-x: visible;
		clear: both;
		line-height: 0;
	}
	.adthrive-ad.adthrive-sidebar.adthrive-sidebar-9.adthrive-sticky {
top: 3rem
}

.adthrive-content.adthrive-ad-cls {
min-height: 90px !important;
}</style>
<script data-no-optimize="1" data-cfasync="false">
	window.adthriveCLS = {
		enabledLocations: ['Content', 'Recipe'],
		injectedSlots: [],
		injectedFromPlugin: true,
		branch: '7025d0b',bucket: 'prod',			};
	window.adthriveCLS.siteAds = {"siteId":"5d4c8ca4693e634b2e5d98cf","siteName":"Machine Learning Mastery","betaTester":false,"targeting":[{"value":"5d4c8ca4693e634b2e5d98cf","key":"siteId"},{"value":"6233884dd842a370880ea737","key":"organizationId"},{"value":"Machine Learning Mastery","key":"siteName"},{"value":"Prime","key":"service"},{"value":"on","key":"bidding"},{"value":["Tech"],"key":"verticals"}],"breakpoints":{"tablet":768,"desktop":1024},"adUnits":[{"sequence":null,"targeting":[{"value":["Sidebar"],"key":"location"}],"devices":["desktop","tablet"],"name":"Sidebar","sticky":false,"location":"Sidebar","dynamic":{"pageSelector":"","spacing":0,"max":1,"lazy":false,"lazyMax":null,"elementSelector":".widget #right-sidebar","skip":0,"classNames":[],"position":"afterbegin","every":1,"enabled":true},"adSizes":[[300,250]],"priority":299,"autosize":false},{"sequence":null,"targeting":[{"value":["Content"],"key":"location"}],"devices":["desktop","tablet"],"name":"Content","sticky":false,"location":"Content","dynamic":{"pageSelector":"body.post-template-default","spacing":1.5,"max":9,"lazy":true,"lazyMax":90,"elementSelector":".entry > h3, .entry > h4, .entry > h2","skip":1,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"adSizes":[[1,1],[1,2],[250,250],[300,250],[300,300],[320,100],[336,280],[468,60],[552,334],[728,90],[728,250],[300,200],[320,300]],"priority":199,"autosize":true},{"sequence":null,"targeting":[{"value":["Content"],"key":"location"}],"devices":["phone"],"name":"Content","sticky":false,"location":"Content","dynamic":{"pageSelector":"body.post-template-default","spacing":1.5,"max":9,"lazy":true,"lazyMax":90,"elementSelector":".entry > h3, .entry > h4, .entry > h2","skip":1,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"adSizes":[[1,1],[1,2],[250,250],[300,50],[300,250],[300,300],[320,50],[320,100],[300,200],[320,300]],"priority":199,"autosize":true},{"sequence":1,"targeting":[{"value":["Below Post"],"key":"location"}],"devices":["desktop","tablet","phone"],"name":"Below_Post_1","sticky":false,"location":"Below Post","dynamic":{"pageSelector":"","spacing":0,"max":0,"lazy":true,"lazyMax":1,"elementSelector":".crp_related  ","skip":0,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"adSizes":[[1,1],[250,250],[300,250],[320,50],[320,100],[336,280],[468,60],[728,90],[728,250],[970,250],[300,50],[300,200],[300,300],[320,300]],"priority":99,"autosize":true},{"sequence":null,"targeting":[{"value":["Footer"],"key":"location"},{"value":true,"key":"sticky"}],"devices":["desktop","tablet","phone"],"name":"Footer","sticky":true,"location":"Footer","dynamic":{"pageSelector":"body.post-template-default","spacing":0,"max":1,"lazy":false,"lazyMax":null,"elementSelector":"body","skip":0,"classNames":[],"position":"beforeend","every":1,"enabled":true},"adSizes":[[320,50],[320,100],[728,90],[970,90],[468,60],[1,1],[300,50]],"priority":-1,"autosize":true}],"adDensityLayout":{"mobile":{"adDensity":0.22,"onePerViewport":false},"pageOverrides":[{"mobile":{"adDensity":0.22,"onePerViewport":false},"pageSelector":"body.post-template-default","desktop":{"adDensity":0.22,"onePerViewport":false}}],"desktop":{"adDensity":0.22,"onePerViewport":false}},"adDensityEnabled":true,"siteExperiments":[],"adTypes":{"nativeDesktopContent":true,"outstreamDesktop":false,"miniscroller":true,"animatedFooter":true,"largeFormatsMobile":false,"nativeMobileContent":true,"inRecipeRecommendationMobile":true,"nativeMobileRecipe":true,"expandableFooter":false,"nativeDesktopSidebar":true,"interscroller":false,"nativeDesktopRecipe":true,"outstreamMobile":true,"largeFormatsDesktop":false,"inRecipeRecommendationDesktop":true},"adOptions":{"theTradeDesk":true,"rtbhouse":true,"verizon":true,"undertone":true,"concert":false,"footerCloseButton":true,"teads":true,"pmp":true,"thirtyThreeAcross":false,"sharethrough":true,"removeVideoTitleWrapper":false,"pubMatic":true,"roundel":true,"infiniteScroll":false,"yahoossp":true,"stickyContainerConfig":{"recipe":{"minHeight":null,"enabled":false},"blockedSelectors":[],"stickyHeaderSelectors":[],"content":{"minHeight":null,"enabled":false}},"sonobi":true,"yieldmo":true,"footerSelector":"","amazonUAM":true,"gamMCMEnabled":true,"gamMCMChildNetworkCode":"22523581566","stickyContainerAds":false,"rubiconMediaMath":true,"rubicon":true,"conversant":true,"resetdigital":true,"openx":true,"mobileHeaderHeight":1,"unruly":true,"mediaGrid":true,"bRealTime":true,"gumgum":true,"comscoreFooter":false,"desktopInterstitial":false,"footerCloseButtonDesktop":true,"isAutoOptimized":false,"comscoreTAL":true,"brightroll":true,"targetaff":false,"tripleLiftMobile":true,"advancePlaylistOptions":{"playlistPlayer":{"enabled":true},"relatedPlayer":{"enabled":true,"applyToFirst":true}},"kargo":true,"liveRampATS":true,"footerCloseButtonMobile":true,"interstitialBlockedPageSelectors":"","allowSmallerAdSizes":true,"comscore":null,"mobileInterstitial":false,"tripleLift":true,"sensitiveCategories":["alc","ast","cbd","conl","cosm","dat","dlu","drg","gamc","gamv","grq","pol","rel","sst","ssr","srh","ske","tob","wtl"],"liveRamp":true,"adthriveEmailIdentity":true,"criteo":true,"nativo":true,"infiniteScrollOptions":{"selector":"","heightThreshold":0},"dynamicContentSlotLazyLoading":true,"clsOptimizedAds":true,"colossus":true,"verticals":["Tech"],"inImage":false,"advancePlaylist":true,"delayLoading":true,"tripleLiftDesktop":false,"inImageZone":null,"appNexus":false,"liveRampId":"","infiniteScrollRefresh":false,"indexExchange":true},"videoPlayers":{"contextual":{"autoplayCollapsibleEnabled":false,"overrideEmbedLocation":false,"defaultPlayerType":"static"},"videoEmbed":"div","footerSelector":"","players":[{"devices":["desktop","mobile"],"description":"","id":4062751,"title":"Stationary related player - desktop and mobile","type":"stationaryRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["desktop"],"description":"","elementSelector":"","skip":0,"id":4062752,"position":"afterend","title":"Sticky related player - desktop","type":"stickyRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["mobile"],"mobileLocation":"top-right","description":"","elementSelector":"","skip":0,"id":4062753,"position":"afterend","title":"Sticky related player - mobile","type":"stickyRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["desktop"],"description":"","skip":0,"title":"","type":"stickyPlaylist","enabled":false,"footerSelector":"","elementSelector":"","id":4062754,"position":"afterend","saveVideoCloseState":false,"shuffle":true},{"pageSelector":"","devices":["mobile"],"mobileLocation":"top-right","description":"","skip":0,"title":"","type":"stickyPlaylist","enabled":false,"footerSelector":"","elementSelector":"","id":4062755,"position":"afterend","saveVideoCloseState":false,"shuffle":true},{"pageSelector":"","devices":["desktop"],"description":"","elementSelector":"","skip":0,"id":4062756,"position":"afterend","title":"","type":"sekindo","enabled":false},{"pageSelector":"","devices":["mobile"],"description":"","elementSelector":"","skip":0,"id":4062757,"position":"afterend","title":"","type":"sekindo","enabled":false}],"partners":{"theTradeDesk":true,"unruly":true,"mediaGrid":true,"undertone":true,"gumgum":true,"pmp":true,"kargo":true,"thirtyThreeAcross":false,"stickyOutstream":{"allowOnHomepage":false,"mobile":{"enabled":false},"desktop":{"enabled":false},"blockedPageSelectors":"","allowForPageWithStickyPlayer":{"enabled":false}},"sharethrough":true,"tripleLift":true,"pubMatic":true,"roundel":true,"yahoossp":true,"criteo":true,"colossus":true,"telaria":true,"yieldmo":true,"amazonUAM":true,"rubicon":true,"appNexus":false,"conversant":true,"resetdigital":true,"openx":true,"spotx":true,"indexExchange":true}}};</script>
<script data-no-optimize="1" data-cfasync="false">
(function(w, d) {
	w.adthrive = w.adthrive || {};
	w.adthrive.cmd = w.adthrive.cmd || [];
	w.adthrive.plugin = 'adthrive-ads-3.3.1';
	w.adthrive.host = 'ads.adthrive.com';
	w.adthrive.integration = 'plugin';

	var commitParam = (w.adthriveCLS && w.adthriveCLS.bucket !== 'prod' && w.adthriveCLS.branch) ? '&commit=' + w.adthriveCLS.branch : '';

	var s = d.createElement('script');
	s.async = true;
	s.referrerpolicy='no-referrer-when-downgrade';
	s.src = 'https://' + w.adthrive.host + '/sites/5d4c8ca4693e634b2e5d98cf/ads.min.js?referrer=' + w.encodeURIComponent(w.location.href) + commitParam + '&cb=' + (Math.floor(Math.random() * 100) + 1) + '';
	var n = d.getElementsByTagName('script')[0];
	n.parentNode.insertBefore(s, n);
})(window, document);
</script>

<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport" />

<title>How to Grid Search Hyperparameters for PyTorch Models - MachineLearningMastery.com</title>
<link rel="canonical" href="https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How to Grid Search Hyperparameters for PyTorch Models - MachineLearningMastery.com" />
<meta property="og:description" content="The &ldquo;weights&rdquo; of a neural network is referred as &ldquo;parameters&rdquo; in PyTorch code and it is fine-tuned by optimizer during training. On the contrary, hyperparameters are the parameters of a neural network that is fixed by design and not tuned by training. Examples are the number of hidden layers and the choice of activation functions. [&hellip;]" />
<meta property="og:url" content="https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" />
<meta property="og:site_name" content="MachineLearningMastery.com" />
<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/" />
<meta property="article:published_time" content="2023-02-09T13:35:17+00:00" />
<meta property="article:modified_time" content="2023-04-07T19:20:18+00:00" />
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg" />
<meta property="og:image:width" content="1920" />
<meta property="og:image:height" content="1282" />
<meta property="og:image:type" content="image/jpeg" />
<meta name="author" content="Adrian Tam" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Adrian Tam" />
<meta name="twitter:label2" content="Est. reading time" />
<meta name="twitter:data2" content="22 minutes" />
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#article","isPartOf":{"@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/"},"author":{"name":"Adrian Tam","@id":"https://machinelearningmastery.com/#/schema/person/49c5655b80a5a31741dd72b73c7779e3"},"headline":"How to Grid Search Hyperparameters for PyTorch Models","datePublished":"2023-02-09T13:35:17+00:00","dateModified":"2023-04-07T19:20:18+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/"},"wordCount":2470,"commentCount":0,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg","articleSection":["Deep Learning with PyTorch"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#respond"]}]},{"@type":"WebPage","@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/","url":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/","name":"How to Grid Search Hyperparameters for PyTorch Models - MachineLearningMastery.com","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#primaryimage"},"image":{"@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg","datePublished":"2023-02-09T13:35:17+00:00","dateModified":"2023-04-07T19:20:18+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#primaryimage","url":"https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg","width":1920,"height":1282,"caption":"Photo by brandon siu. Some rights reserved."},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://machinelearningmastery.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://machinelearningmastery.com/blog/"},{"@type":"ListItem","position":3,"name":"How to Grid Search Hyperparameters for PyTorch Models"}]},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"MachineLearningMastery.com","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://machinelearningmastery.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://machinelearningmastery.com/#/schema/logo/image/","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/MachineLearningMastery/","https://twitter.com/TeachTheMachine","https://www.linkedin.com/company/machine-learning-mastery"]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/49c5655b80a5a31741dd72b73c7779e3","name":"Adrian Tam","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://machinelearningmastery.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=96&d=mm&r=g","caption":"Adrian Tam"},"description":"Adrian Tam, PhD is a data scientist and software engineer.","url":"https://machinelearningmastery.com/author/adriantam/"}]}</script>

<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//ads.adthrive.com' />
<link rel='dns-prefetch' href='//www.google-analytics.com' />
<link rel='dns-prefetch' href='//loadeu.exelator.com' />
<link rel='dns-prefetch' href='//sync.crwdcntrl.net' />
<link rel='dns-prefetch' href='//gdpr-wrapper.privacymanager.io' />
<link rel='dns-prefetch' href='//securepubads.g.doubleclick.net' />
<link rel='dns-prefetch' href='//gdpr.privacymanager.io' />
<link rel='dns-prefetch' href='//sb.scorecardresearch.com' />
<link rel='dns-prefetch' href='//confiant-integrations.global.ssl.fastly.net' />
<link rel="alternate" type="application/rss+xml" title="MachineLearningMastery.com &raquo; Feed" href="https://feeds.feedburner.com/MachineLearningMastery" />
<link rel="alternate" type="application/rss+xml" title="MachineLearningMastery.com &raquo; Comments Feed" href="https://machinelearningmastery.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="MachineLearningMastery.com &raquo; How to Grid Search Hyperparameters for PyTorch Models Comments Feed" href="https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/feed/" />

<script src="//www.googletagmanager.com/gtag/js?id=UA-44039733-3" data-cfasync="false" data-wpfc-render="false" type="text/javascript" async></script>
<script data-cfasync="false" data-wpfc-render="false" type="text/javascript">
				var mi_version = '8.15';
				var mi_track_user = true;
				var mi_no_track_reason = '';
				
								var disableStrs = [
										'ga-disable-G-JZP3DWZZ8W',
															'ga-disable-UA-44039733-3',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for (var index = 0; index < disableStrs.length; index++) {
						if (document.cookie.indexOf(disableStrs[index] + '=true') > -1) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if (__gtagTrackerIsOptedOut()) {
					for (var index = 0; index < disableStrs.length; index++) {
						window[disableStrs[index]] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for (var index = 0; index < disableStrs.length; index++) {
						document.cookie = disableStrs[index] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[disableStrs[index]] = true;
					}
				}

				if ('undefined' === typeof gaOptout) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if (mi_track_user) {
					function __gtagDataLayer() {
						dataLayer.push(arguments);
					}

					function __gtagTracker(type, name, parameters) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply(null, arguments);
							return;
						}

						if (type === 'event') {
														parameters.send_to = monsterinsights_frontend.v4_id;
							var hookName = name;
							if (typeof parameters['event_category'] !== 'undefined') {
								hookName = parameters['event_category'] + ':' + name;
							}

							if (typeof MonsterInsightsDualTracker.trackers[hookName] !== 'undefined') {
								MonsterInsightsDualTracker.trackers[hookName](parameters);
							} else {
								__gtagDataLayer('event', name, parameters);
							}
							
														parameters.send_to = monsterinsights_frontend.ua;
							__gtagDataLayer(type, name, parameters);
													} else {
							__gtagDataLayer.apply(null, arguments);
						}
					}

					__gtagTracker('js', new Date());
					__gtagTracker('set', {
						'developer_id.dZGIzZG': true,
											});
										__gtagTracker('config', 'G-JZP3DWZZ8W', {"forceSSL":"true","author":"Adrian Tam","category":"Deep Learning with PyTorch"} );
															__gtagTracker('config', 'UA-44039733-3', {"forceSSL":"true","dimension1":"Adrian Tam","dimension2":"Deep Learning with PyTorch"} );
										window.gtag = __gtagTracker;										(function () {
						/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
						/* ga and __gaTracker compatibility shim. */
						var noopfn = function () {
							return null;
						};
						var newtracker = function () {
							return new Tracker();
						};
						var Tracker = function () {
							return null;
						};
						var p = Tracker.prototype;
						p.get = noopfn;
						p.set = noopfn;
						p.send = function () {
							var args = Array.prototype.slice.call(arguments);
							args.unshift('send');
							__gaTracker.apply(null, args);
						};
						var __gaTracker = function () {
							var len = arguments.length;
							if (len === 0) {
								return;
							}
							var f = arguments[len - 1];
							if (typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function') {
								if ('send' === arguments[0]) {
									var hitConverted, hitObject = false, action;
									if ('event' === arguments[1]) {
										if ('undefined' !== typeof arguments[3]) {
											hitObject = {
												'eventAction': arguments[3],
												'eventCategory': arguments[2],
												'eventLabel': arguments[4],
												'value': arguments[5] ? arguments[5] : 1,
											}
										}
									}
									if ('pageview' === arguments[1]) {
										if ('undefined' !== typeof arguments[2]) {
											hitObject = {
												'eventAction': 'page_view',
												'page_path': arguments[2],
											}
										}
									}
									if (typeof arguments[2] === 'object') {
										hitObject = arguments[2];
									}
									if (typeof arguments[5] === 'object') {
										Object.assign(hitObject, arguments[5]);
									}
									if ('undefined' !== typeof arguments[1].hitType) {
										hitObject = arguments[1];
										if ('pageview' === hitObject.hitType) {
											hitObject.eventAction = 'page_view';
										}
									}
									if (hitObject) {
										action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
										hitConverted = mapArgs(hitObject);
										__gtagTracker('event', action, hitConverted);
									}
								}
								return;
							}

							function mapArgs(args) {
								var arg, hit = {};
								var gaMap = {
									'eventCategory': 'event_category',
									'eventAction': 'event_action',
									'eventLabel': 'event_label',
									'eventValue': 'event_value',
									'nonInteraction': 'non_interaction',
									'timingCategory': 'event_category',
									'timingVar': 'name',
									'timingValue': 'value',
									'timingLabel': 'event_label',
									'page': 'page_path',
									'location': 'page_location',
									'title': 'page_title',
								};
								for (arg in args) {
																		if (!(!args.hasOwnProperty(arg) || !gaMap.hasOwnProperty(arg))) {
										hit[gaMap[arg]] = args[arg];
									} else {
										hit[arg] = args[arg];
									}
								}
								return hit;
							}

							try {
								f.hitCallback();
							} catch (ex) {
							}
						};
						__gaTracker.create = newtracker;
						__gaTracker.getByName = newtracker;
						__gaTracker.getAll = function () {
							return [];
						};
						__gaTracker.remove = noopfn;
						__gaTracker.loaded = true;
						window['__gaTracker'] = __gaTracker;
					})();
									} else {
										console.log("");
					(function () {
						function __gtagTracker() {
							return null;
						}

						window['__gtagTracker'] = __gtagTracker;
						window['gtag'] = __gtagTracker;
					})();
									}
			</script>

<script id="machi-ready" type="73c9f148f6d44e5e000b4ea0-text/javascript">
			window.advanced_ads_ready=function(e,a){a=a||"complete";var d=function(e){return"interactive"===a?"loading"!==e:"complete"===e};d(document.readyState)?e():document.addEventListener("readystatechange",(function(a){d(a.target.readyState)&&e()}),{once:"interactive"===a})},window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[];		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style type="text/css">
@media only screen and (min-width: 980px) {
body.two-col-left-1070 #main-sidebar-container { width: 100%; }
body.two-col-left-1070 #main-sidebar-container #sidebar { width: 28.385%; }
body.two-col-left-1070 #main-sidebar-container #main { width: 68.385%; }
}
</style>
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 1070px; max-width: 1070px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 1070px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.4' id='jquery-core-js'></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.0' id='jquery-migrate-js'></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='urvanov_syntax_highlighter_js-js-extra'>
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.33","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js?ver=2.8.33' id='urvanov_syntax_highlighter_js-js' defer></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-content/plugins/google-analytics-premium/assets/js/frontend-gtag.min.js?ver=8.15' id='monsterinsights-frontend-script-js' defer></script>
<script data-cfasync="false" data-wpfc-render="false" type="text/javascript" id='monsterinsights-frontend-script-js-extra'>/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/machinelearningmastery.com","hash_tracking":"false","ua":"UA-44039733-3","v4_id":"G-JZP3DWZZ8W"};/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/plugins/simple-social-buttons/assets/js/frontend-blocks.js?ver=4.1.1' id='ssb-blocks-front-js-js' defer></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"3ff67488f3"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-minify="1" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=1686601679' id='ssb-front-js-js' defer></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='advanced-ads-advanced-js-js-extra'>
/* <![CDATA[ */
var advads_options = {"blog_id":"1","privacy":{"enabled":false,"state":"not_needed"}};
/* ]]> */
</script>
<script data-minify="1" type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/uploads/444/686/public/assets/js/32.js?ver=1686601680' id='advanced-ads-advanced-js-js'></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='advanced_ads_pro/visitor_conditions-js-extra'>
/* <![CDATA[ */
var advanced_ads_pro_visitor_conditions = {"referrer_cookie_name":"advanced_ads_pro_visitor_referrer","referrer_exdays":"365","page_impr_cookie_name":"advanced_ads_page_impressions","page_impr_exdays":"3650"};
/* ]]> */
</script>
<script data-minify="1" type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/uploads/444/337/52/395/640/770.js?ver=1686601680' id='advanced_ads_pro/visitor_conditions-js'></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=6.2.2' id='third-party-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2' id='modernizr-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=6.2.2' id='general-js' defer></script>

<style type="text/css">
	.col-full, #wrapper { max-width: 1070px !important; }
</style>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/" /><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/14630" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 6.2.2" />
<link rel='shortlink' href='https://machinelearningmastery.com/?p=14630' />
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-grid-search-hyperparameters-for-pytorch-models%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-grid-search-hyperparameters-for-pytorch-models%2F&#038;format=xml" />
<style type="text/css">.crp_title {
    font-size: medium;
}
.group.portfolio-img img {
    height: auto;
    padding: 3px;
	  border: 0px solid #fff;
    background: rgba(255,255,255,.7);
}
.crp_related ul li {
    background: #fff;
    padding: 3px;
    margin: 0 0 1em;
    width: 100%;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-shadow: 0 0px 0px 0 rgb(0 0 0 / 18%);
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border: 0px solid #fff;
    animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -webkit-animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -moz-animation: wzslideup .8s ease-out,wzfadein 1s ease;
    font-size: 1em;
    text-align: center;
    display: inline-block;
}</style> <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<meta property="og:title" content="How to Grid Search Hyperparameters for PyTorch Models - MachineLearningMastery.com" />
<meta property="og:description" content="The " weights" of a neural network is referred as "parameters" in PyTorch code and it is fine-tuned by optimizer during training. On the contrary, hyperparameters are the parameters of a neural network that is fixed by design and not tuned by training. Examples are the number of hidden layers and the choice of activation functions. Hyperparameter optimization is a big" />
<meta property="og:url" content="https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" />
<meta property="og:site_name" content="MachineLearningMastery.com" />
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="The " weights" of a neural network is referred as "parameters" in PyTorch code and it is fine-tuned by optimizer during training. On the contrary, hyperparameters are the parameters of a neural network that is fixed by design and not tuned by training. Examples are the number of hidden layers and the choice of activation functions. Hyperparameter optimization is a big" />
<meta name="twitter:title" content="How to Grid Search Hyperparameters for PyTorch Models - MachineLearningMastery.com" />
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg" />
<script type="rocketlazyloadscript" data-rocket-type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<link rel="dns-prefetch" href="https://ads.adthrive.com/"><link rel="preconnect" href="https://ads.adthrive.com/"><link rel="preconnect" href="https://ads.adthrive.com/" crossorigin><script type="73c9f148f6d44e5e000b4ea0-text/javascript">
		var advadsCfpQueue = [];
		var advadsCfpAd = function( adID ){
			if ( 'undefined' == typeof advadsProCfp ) { advadsCfpQueue.push( adID ) } else { advadsProCfp.addElement( adID ) }
		};
		</script>

<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png" />

<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>



<meta name="generator" content="Canvas 5.9.21" />
<meta name="generator" content="WooFramework 6.2.9" />
<script type="rocketlazyloadscript" data-rocket-type="text/javascript">
			if ( typeof advadsGATracking === 'undefined' ) {
				window.advadsGATracking = {
					delayedAds: {},
					deferedAds: {}
				};
			}
		</script>
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" />
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" />
<script data-no-optimize='1' data-cfasync='false' id='cls-disable-ads-7025d0b'>'use strict';var cls_disable_ads=function(n){function h(a,b){var c="function"===typeof Symbol&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[];try{for(;(void 0===b||0<b--)&&!(d=a.next()).done;)e.push(d.value)}catch(l){var f={error:l}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error;}}return e}function k(a,b,c){if(c||2===arguments.length)for(var d=0,e=b.length,f;d<e;d++)!f&&d in b||(f||(f=Array.prototype.slice.call(b,0,d)),f[d]=b[d]);return a.concat(f||Array.prototype.slice.call(b))}
window.adthriveCLS.buildDate="2023-06-16";var B=new (function(){function a(){}a.prototype.info=function(b,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];this.call.apply(this,k([console.info,b,c],h(d),!1))};a.prototype.warn=function(b,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];this.call.apply(this,k([console.warn,b,c],h(d),!1))};a.prototype.error=function(b,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];this.call.apply(this,k([console.error,b,c],
h(d),!1));this.sendErrorLogToCommandQueue.apply(this,k([b,c],h(d),!1))};a.prototype.event=function(b,c){for(var d,e=2;e<arguments.length;e++);"debug"===(null===(d=window.adthriveCLS)||void 0===d?void 0:d.bucket)&&this.info(b,c)};a.prototype.sendErrorLogToCommandQueue=function(b,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];window.adthrive=window.adthrive||{};window.adthrive.cmd=window.adthrive.cmd||[];window.adthrive.cmd.push(function(){void 0!==window.adthrive.logError&&"function"===
typeof window.adthrive.logError&&window.adthrive.logError(b,c,d)}.bind(b,c,d))};a.prototype.call=function(b,c,d){for(var e=[],f=3;f<arguments.length;f++)e[f-3]=arguments[f];f=["%c".concat(c,"::").concat(d," ")];var l=["color: #999; font-weight: bold;"];0<e.length&&"string"===typeof e[0]&&f.push(e.shift());l.push.apply(l,k([],h(e),!1));try{Function.prototype.apply.call(b,console,k([f.join("")],h(l),!1))}catch(A){console.error(A)}};return a}()),g;(function(a){a.ThirtyThreeAcross="33across";a.AppNexus=
"appnexus";a.Amazon="amazon";a.Colossus="colossus";a.ColossusServer="col_ss";a.Conversant="conversant";a.Concert="concert";a.Criteo="criteo";a.GumGum="gumgum";a.IndexExchange="ix";a.Kargo="kargo";a.KargoServer="krgo_ss";a.MediaGrid="grid";a.MediaGridVideo="gridvid";a.Nativo="nativo";a.OpenX="openx";a.OpenXServer="opnx_ss";a.Pubmatic="pubmatic";a.PubmaticServer="pubm_ss";a.ResetDigital="resetdigital";a.Roundel="roundel";a.Rtbhouse="rtbhouse";a.Rubicon="rubicon";a.RubiconServer="rubi_ss";a.Sharethrough=
"sharethrough";a.Spotx="spotx";a.Teads="teads";a.Triplelift="triplelift";a.TripleliftServer="tripl_ss";a.TTD="ttd";a.Undertone="undertone";a.UndertoneServer="under_ss";a.Unruly="unruly";a.YahooSSP="yahoossp";a.Verizon="verizon";a.Yieldmo="yieldmo"})(g||(g={}));var m;(function(a){a.Prebid="prebid";a.GAM="gam";a.Amazon="amazon";a.WebVitals="webvitals";a.Marmalade="marmalade";a.Floors="floors";a.CMP="cmp"})(m||(m={}));var q;(function(a){a.fpvNonLazy="fpvNonLazy";a.lazy="lazy";a.refresh="refresh";a.session=
"session";a.crossDomain="crossdomain";a.highSequence="highsequence"})(q||(q={}));var r;(function(a){a.prebidLoad="prebidLoad";a.amazonLoad="amazonLoad";a.gptLoad="gptLoad"})(r||(r={}));var t;(function(a){a.Desktop="desktop";a.Mobile="mobile"})(t||(t={}));var u;(function(a){a.Video_Collapse_Autoplay_SoundOff="Video_Collapse_Autoplay_SoundOff";a.Video_Individual_Autoplay_SOff="Video_Individual_Autoplay_SOff";a.Video_Coll_SOff_Smartphone="Video_Coll_SOff_Smartphone";a.Video_In_Post_ClicktoPlay_SoundOn=
"Video_In-Post_ClicktoPlay_SoundOn"})(u||(u={}));var v;(v||(v={})).None="none";var w;(function(a){a.WEIGHTEDCHOICE="weightedChoice";a.BERNOULLITRIAL="bernoulliTrial"})(w||(w={}));var x;(function(a){a.INTEGER="integer";a.FLOAT="float";a.BOOLEAN="boolean";a.STRING="string"})(x||(x={}));var y;(function(a){a.DESKTOP="desktop";a.MOBILE="mobile";a.ALL="all"})(y||(y={}));var z;(function(a){a.AdDensity="addensity";a.AdLayout="adlayout";a.FooterCloseButton="footerclose";a.Interstitial="interstitial";a.RemoveVideoTitleWrapper=
"removevideotitlewrapper";a.StickyOutstream="stickyoutstream";a.StickyOutstreamOnStickyPlayer="sospp";a.VideoAdvancePlaylistRelatedPlayer="videoadvanceplaylistrp";a.MobileStickyPlayerPosition="mspp"})(z||(z={}));g=function(){function a(){this._timeOrigin=0}a.prototype.resetTimeOrigin=function(){this._timeOrigin=window.performance.now()};a.prototype.now=function(){try{return Math.round(window.performance.now()-this._timeOrigin)}catch(b){return 0}};return a}();window.adthrive.windowPerformance=window.adthrive.windowPerformance||
new g;g=window.adthrive.windowPerformance;g.now.bind(g);var p=function(a){var b=window.location.href;return a.some(function(c){return(new RegExp(c,"i")).test(b)})};g=function(){function a(b){this.adthrive=b;this.video=this.recipe=this.content=this.all=!1;this.locations=new Set;this.reasons=new Set;if(this.urlHasEmail(window.location.href)||this.urlHasEmail(window.document.referrer))this.all=!0,this.reasons.add("all_email");try{this.checkCommandQueue(),null!==document.querySelector(".tag-novideo")&&
(this.video=!0,this.locations.add("Video"),this.reasons.add("video_tag"))}catch(c){B.error("ClsDisableAds","checkCommandQueue",c)}}a.prototype.checkCommandQueue=function(){var b=this;this.adthrive&&this.adthrive.cmd&&this.adthrive.cmd.forEach(function(c){c=c.toString();var d=b.extractAPICall(c,"disableAds");d&&b.disableAllAds(b.extractPatterns(d));(d=b.extractAPICall(c,"disableContentAds"))&&b.disableContentAds(b.extractPatterns(d));(c=b.extractAPICall(c,"disablePlaylistPlayers"))&&b.disablePlaylistPlayers(b.extractPatterns(c))})};
a.prototype.extractPatterns=function(b){b=b.match(/["'](.*?)['"]/g);if(null!==b)return b.map(function(c){return c.replace(/["']/g,"")})};a.prototype.extractAPICall=function(b,c){b=b.match(new RegExp(c+"\\((.*?)\\)","g"));return null!==b?b[0]:!1};a.prototype.disableAllAds=function(b){if(!b||p(b))this.all=!0,this.reasons.add("all_page")};a.prototype.disableContentAds=function(b){if(!b||p(b))this.recipe=this.content=!0,this.locations.add("Content"),this.locations.add("Recipe"),this.reasons.add("content_plugin")};
a.prototype.disablePlaylistPlayers=function(b){if(!b||p(b))this.video=!0,this.locations.add("Video"),this.reasons.add("video_page")};a.prototype.urlHasEmail=function(b){return b?null!==/([A-Z0-9._%+-]+(@|%(25)*40)[A-Z0-9.-]+\.[A-Z]{2,})/i.exec(b):!1};return a}();if(m=window.adthriveCLS)m.disableAds=new g(window.adthrive);n.ClsDisableAds=g;Object.defineProperty(n,"__esModule",{value:!0});return n}({})
</script> <style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>
</head>
<body class="post-template-default single single-post postid-14630 single-format-standard safari iphone alt-style-default two-col-left width-1070 two-col-left-1070 aa-prefix-machi-">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header id="header" class="col-full">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img width="480" height="80" src="https://machinelearningmastery.com/wp-content/uploads/2019/09/Header_smaller_text_better-1.png" alt="MachineLearningMastery.com" /></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">MachineLearningMastery.com</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div id="custom_html-118" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
<script type="rocketlazyloadscript" data-rocket-src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <a href="" data-leadbox-popup="GqouzfdocqLn3kDs8PKh7h" data-leadbox-domain="machinelearningmastery.lpages.co">Click here Take the FREE Deep Learning with PyTorch Crash-Course</a>
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
<form method="get" class="searchform" action="https://machinelearningmastery.com/">
<input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == 'Search...') {this.value = '';}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == '') {this.value = 'Search...';}" data-cf-modified-73c9f148f6d44e5e000b4ea0-="" />
<input type="hidden" name="post_type" value="post" />
<button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav id="navigation" class="col-full" role="navigation">
<section class="menus">
<a href="https://machinelearningmastery.com" class="nav-home"><span>Home</span></a>
<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li id="menu-item-14062" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-14062"><a href="https://machinelearningmastery.com/category/attention/">Attention</a></li>
<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
<li id="menu-item-13302" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-13302"><a href="https://machinelearningmastery.com/category/calculus/">Calculus</a></li>
<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
<li id="menu-item-12825" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12825"><a href="https://machinelearningmastery.com/category/optimization/">Optimization</a></li>
<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li id="menu-item-13672" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-13672"><a href="https://machinelearningmastery.com/category/python-for-machine-learning/">Python for Machine Learning</a></li>
<li id="menu-item-14782" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-14782"><a href="https://machinelearningmastery.com/category/deep-learning-with-pytorch/">Deep Learning with PyTorch</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div>
</section>
<a href="#top" class="nav-close"><span>Return to Content</span></a>
</nav>


<div class="machi-effbef381c8b8c4dc105f81c84554449 machi-header" id="machi-effbef381c8b8c4dc105f81c84554449"></div>

<div id="content" class="col-full">
<div id="main-sidebar-container">

<section id="main">
<article class="post-14630 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-with-pytorch">
<header>
<h1 class="title entry-title">How to Grid Search Hyperparameters for PyTorch Models</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/adriantam/" title="Posts by Adrian Tam" rel="author">Adrian Tam</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2023-02-10T00:35:17+1100">February 10, 2023</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-with-pytorch/" title="View all items in Deep Learning with PyTorch">Deep Learning with PyTorch</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-14630 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" rel="nofollow" target="_blank" data-href="https://twitter.com/intent/tweet?text=How+to+Grid+Search+Hyperparameters+for+PyTorch+Models&url=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z" /><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" /></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_tweet-icon" rel="nofollow" target="_blank" data-href="https://twitter.com/intent/tweet?text=How+to+Grid+Search+Hyperparameters+for+PyTorch+Models&url=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z" /><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" /></svg></span><i class="simplesocialtxt">Tweet </i></button> <button class="ssb_fbshare-icon" rel="nofollow" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" rel="nofollow" target="_blank" data-href="https://www.linkedin.com/sharing/share-offsite/?url=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" /> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" /> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" /> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on April 8, 2023</p>
<p>The &#8220;weights&#8221; of a neural network is referred as &#8220;parameters&#8221; in PyTorch code and it is fine-tuned by optimizer during training. On the contrary, hyperparameters are the parameters of a neural network that is fixed by design and not tuned by training. Examples are the number of hidden layers and the choice of activation functions. Hyperparameter optimization is a big part of deep learning. The reason is that neural networks are notoriously difficult to configure, and a lot of parameters need to be set. On top of that, individual models can be very slow to train.</p>
<p>In this post, you will discover how to use the grid search capability from the scikit-learn Python machine learning library to tune the hyperparameters of PyTorch deep learning models. After reading this post, you will know:</p>
<ul>
<li>How to wrap PyTorch models for use in scikit-learn and how to use grid search</li>
<li>How to grid search common neural network parameters, such as learning rate, dropout rate, epochs, and number of neurons</li>
<li>How to define your own hyperparameter tuning experiments on your own projects</li>
</ul>
<p><p><strong>Kick-start your project</strong> with my book <a href="https://machinelearningmastery.com/deep-learning-with-pytorch/">Deep Learning with PyTorch</a>. It provides <strong>self-study tutorials</strong> with <strong>working code</strong>.</p><br />
Let’s get started.</p>
<div id="attachment_14631" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-14631" decoding="async" class="wp-image-14631" src="https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg" alt="" width="800" height="534" srcset="https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash.jpg 1920w, https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash-300x200.jpg 300w, https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash-1024x684.jpg 1024w, https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash-768x513.jpg 768w, https://machinelearningmastery.com/wp-content/uploads/2023/02/brandon-siu-2ePI2R4ka0I-unsplash-1536x1026.jpg 1536w" sizes="(max-width: 800px) 100vw, 800px" /><p id="caption-attachment-14631" class="wp-caption-text">How to Grid Search Hyperparameters for PyTorch Models<br />Photo by <a href="https://unsplash.com/photos/2ePI2R4ka0I">brandon siu</a>. Some rights reserved.</p></div>
<h2>Overview</h2>
<p>In this post, you will see how to use the scikit-learn grid search capability with a suite of examples that you can copy-and-paste into your own project as a starting point. Below is a list of the topics we are going to cover:</p>
<ul>
<li>How to use PyTorch models in scikit-learn</li>
<li>How to use grid search in scikit-learn</li>
<li>How to tune batch size and training epochs</li>
<li>How to tune optimization algorithms</li>
<li>How to tune learning rate and momentum</li>
<li>How to tune network weight initialization</li>
<li>How to tune activation functions</li>
<li>How to tune dropout regularization</li>
<li>How to tune the number of neurons in the hidden layer</li>
</ul>
<h2>How to Use PyTorch Models in scikit-learn</h2>
<p>PyTorch models can be used in scikit-learn if wrapped with skorch. This is to leverage the duck-typing nature of Python to make the PyTorch model provide similar API as a scikit-learn model, so everything in scikit-learn can work along. In skorch, there are <code>NeuralNetClassifier</code> for classification neural networks and <code>NeuralNetRegressor</code> for regression neural networks. You may need to run the follownig command to install the module.</p>
<div id="urvanov-syntax-highlighter-649027db4d745685828121" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
pip install skorch</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d745685828121-1">1</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d745685828121-1">pip install skorch</div></div></td>
</tr>
</table>
</div>
</div><p>To use these wrappers, you must define a your PyTorch model as a class using <code>nn.Module</code>, then pass the name of the class to the <code>module</code> argument when constructing the <code>NeuralNetClassifier</code> class. For example:</p>
<div id="urvanov-syntax-highlighter-649027db4d74d340216774" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
class MyClassifier(nn.Module):
    def __init__(self):
        super().__init__()
        ...

    def forward(self, x):
        ...
        return x

# create the skorch wrapper
model = NeuralNetClassifier(
    module=MyClassifier
)</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d74d340216774-13">13</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">MyClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-10"><span class="crayon-p"># create the skorch wrapper</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-11"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">module</span><span class="crayon-o">=</span><span class="crayon-i">MyClassifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d74d340216774-13"><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>The constructor for the <code>NeuralNetClassifier</code> class can take default arguments that are passed on to the calls to <code>model.fit()</code> (the way to invoke a training loop in scikit-learn models), such as the number of epochs and the batch size. For example:</p>
<div id="urvanov-syntax-highlighter-649027db4d750302661012" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
model = NeuralNetClassifier(
    module=MyClassifier,
    max_epochs=150,
    batch_size=10
)</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d750302661012-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d750302661012-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d750302661012-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d750302661012-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d750302661012-5">5</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d750302661012-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d750302661012-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">module</span><span class="crayon-o">=</span><span class="crayon-v">MyClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d750302661012-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d750302661012-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d750302661012-5"><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>The constructor for the <code>NeuralNetClassifier</code> class can also take new arguments that can be passed to your model class&#8217; constructor, but you have to prepend it with <code>module__</code> (with two underscores). These new arguments may carry a default value in the constructor but they will be overridden when the wrapper instantiate the model. For example:</p>
<div id="urvanov-syntax-highlighter-649027db4d752566224167" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import torch.nn as nn
from skorch import NeuralNetClassifier

class SonarClassifier(nn.Module):
    def __init__(self, n_layers=3):
        super().__init__()
        self.layers = []
        self.acts = []
        for i in range(n_layers):
            self.layers.append(nn.Linear(60, 60))
            self.acts.append(nn.ReLU())
            self.add_module(f"layer{i}", self.layers[-1])
            self.add_module(f"act{i}", self.acts[-1])
        self.output = nn.Linear(60, 1)

    def forward(self, x):
        for layer, act in zip(self.layers, self.acts):
            x = act(layer(x))
        x = self.output(x)
        return x

model = NeuralNetClassifier(
    module=SonarClassifier,
    max_epochs=150,
    batch_size=10,
    module__n_layers=2
)</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d752566224167-27">27</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-1"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-2"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-4"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">SonarClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_layers</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">acts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_layers</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">acts</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_module</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-s">"layer{i}"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_module</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-s">"act{i}"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">acts</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">act </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">acts</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-22"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">module</span><span class="crayon-o">=</span><span class="crayon-v">SonarClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d752566224167-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">module__n_layers</span><span class="crayon-o">=</span><span class="crayon-cn">2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d752566224167-27"><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>You can verify the result by initializing a model and print it:</p>
<div id="urvanov-syntax-highlighter-649027db4d755585662024" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print(model.initialize())</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d755585662024-1">1</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d755585662024-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">initialize</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>In this example, you should see:</p>
<div id="urvanov-syntax-highlighter-649027db4d757292722017" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;class 'skorch.classifier.NeuralNetClassifier'&gt;[initialized](
  module_=SonarClassifier(
    (layer0): Linear(in_features=60, out_features=60, bias=True)
    (act0): ReLU()
    (layer1): Linear(in_features=60, out_features=60, bias=True)
    (act1): ReLU()
    (output): Linear(in_features=60, out_features=1, bias=True)
  ),
)</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d757292722017-9">9</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d757292722017-1">&lt;class 'skorch.classifier.NeuralNetClassifier'&gt;[initialized](</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d757292722017-2">&nbsp;&nbsp;module_=SonarClassifier(</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d757292722017-3">&nbsp;&nbsp;&nbsp;&nbsp;(layer0): Linear(in_features=60, out_features=60, bias=True)</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d757292722017-4">&nbsp;&nbsp;&nbsp;&nbsp;(act0): ReLU()</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d757292722017-5">&nbsp;&nbsp;&nbsp;&nbsp;(layer1): Linear(in_features=60, out_features=60, bias=True)</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d757292722017-6">&nbsp;&nbsp;&nbsp;&nbsp;(act1): ReLU()</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d757292722017-7">&nbsp;&nbsp;&nbsp;&nbsp;(output): Linear(in_features=60, out_features=1, bias=True)</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d757292722017-8">&nbsp;&nbsp;),</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d757292722017-9">)</div></div></td>
</tr>
</table>
</div>
</div><p><div class="woo-sc-hr"></div>
<center>
<h3>Want to Get Started With Deep Learning with PyTorch?</h3>
<p>Take my free email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><script type="rocketlazyloadscript" data-rocket-src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <button data-leadbox-popup="ZyDbtTQmPB9exjTPHgh9SH" data-leadbox-domain="machinelearningmastery.lpages.co" style="background: rgb(255, 215, 18);border-color: rgb(255, 215, 18);border-radius: 20px;color: #FFFFFF;display: inline-block;vertical-align: middle;padding: 16px 32px;min-width: 192px;border: 1px solid rgb(255, 215, 18);font-size: 1rem;font-family: Helvetica, Arial, sans-serif;text-align: center;outline: 0;line-height: 1;cursor: pointer;-webkit-transition: background 0.3s, color 0.3s, border 0.3s;transition: background 0.3s, color 0.3s, border 0.3s;  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.6);">Download Your FREE Mini-Course</button></p>
</center>
<div class="woo-sc-hr"></div></p>
<h2>How to Use Grid Search in scikit-learn</h2>
<p>Grid search is a model hyperparameter optimization technique. It simply exhaust all combinations of the hyperparameters and find the one that gave the best score. In scikit-learn, this technique is provided in the <code>GridSearchCV</code> class. When constructing this class, you must provide a dictionary of hyperparameters to evaluate in the <code>param_grid</code> argument. This is a map of the model parameter name and an array of values to try.</p>
<p>By default, accuracy is the score that is optimized, but other scores can be specified in the score argument of the <code>GridSearchCV</code> constructor. The <code>GridSearchCV</code> process will then construct and evaluate one model for each combination of parameters. Cross-validation is used to evaluate each individual model, and the default of 3-fold cross-validation is used, although you can override this by specifying the cv argument to the <code>GridSearchCV</code> constructor.</p>
<p>Below is an example of defining a simple grid search:</p>
<div id="urvanov-syntax-highlighter-649027db4d759008351345" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
param_grid = {
    'epochs': [10,20,30]
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, Y)</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d759008351345-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d759008351345-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d759008351345-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d759008351345-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d759008351345-5">5</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d759008351345-1"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d759008351345-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'epochs'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">30</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d759008351345-3"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d759008351345-4"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d759008351345-5"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>By setting the <code>n_jobs</code> argument in the <code>GridSearchCV</code> constructor to $-1$, the process will use all cores on your machine. Otherwise the grid search process will only run in single thread, which is slower in the multi-core CPUs.</p>
<p>Once completed, you can access the outcome of the grid search in the result object returned from <code>grid.fit()</code>. The <code>best_score_</code> member provides access to the best score observed during the optimization procedure, and the <code>best_params_</code> describes the combination of parameters that achieved the best results. You can learn more about the <code>GridSearchCV</code> class in the scikit-learn API documentation.<br />
<p><strong>Kick-start your project</strong> with my book <a href="https://machinelearningmastery.com/deep-learning-with-pytorch/">Deep Learning with PyTorch</a>. It provides <strong>self-study tutorials</strong> with <strong>working code</strong>.</p></p>
<h2>Problem Description</h2>
<p>Now that you know how to use PyTorch models with scikit-learn and how to use grid search in scikit-learn, let’s look at a bunch of examples.</p>
<p>All examples will be demonstrated on a small standard machine learning dataset called the <a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.csv">Pima Indians onset of diabetes classification dataset</a>. This is a small dataset with all numerical attributes that is easy to work with.</p>
<p>As you proceed through the examples in this post, you will aggregate the best parameters. This is not the best way to grid search because parameters can interact, but it is good for demonstration purposes.</p>
<h2>How to Tune Batch Size and Number of Epochs</h2>
<p>In this first simple example, you will look at tuning the batch size and number of epochs used when fitting the network.</p>
<p>The batch size in iterative gradient descent is the number of patterns shown to the network before the weights are updated. It is also an optimization in the training of the network, defining how many patterns to read at a time and keep in memory.</p>
<p>The number of epochs is the number of times the entire training dataset is shown to the network during training. Some networks are sensitive to the batch size, such as LSTM recurrent neural networks and Convolutional Neural Networks.</p>
<p>Here you will evaluate a suite of different minibatch sizes from 10 to 100 in steps of 20.</p>
<p>The full code listing is provided below:</p>
<div id="urvanov-syntax-highlighter-649027db4d75d413379943" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import random
import numpy as np
import torch
import torch.nn as nn
import torch.optim as optim
from skorch import NeuralNetClassifier
from sklearn.model_selection import GridSearchCV

# load the dataset, split into input (X) and output (y) variables
dataset = np.loadtxt('pima-indians-diabetes.csv', delimiter=',')
X = dataset[:,0:8]
y = dataset[:,8]
X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.float32).reshape(-1, 1)

# PyTorch classifier
class PimaClassifier(nn.Module):
    def __init__(self):
        super().__init__()
        self.layer = nn.Linear(8, 12)
        self.act = nn.ReLU()
        self.output = nn.Linear(12, 1)
        self.prob = nn.Sigmoid()

    def forward(self, x):
        x = self.act(self.layer(x))
        x = self.prob(self.output(x))
        return x

# create model with skorch
model = NeuralNetClassifier(
    PimaClassifier,
    criterion=nn.BCELoss,
    optimizer=optim.Adam,
    verbose=False
)

# define the grid search parameters
param_grid = {
    'batch_size': [10, 20, 40, 60, 80, 100],
    'max_epochs': [10, 50, 100]
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, y)

# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d75d413379943-52">52</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-1"><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-2"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-3"><span class="crayon-e">import </span><span class="crayon-e">torch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-4"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-5"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">optim </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">optim</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-6"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-i">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-9"><span class="crayon-p"># load the dataset, split into input (X) and output (y) variables</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">'pima-indians-diabetes.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-11"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-12"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-14"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-16"><span class="crayon-p"># PyTorch classifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-17"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-30"><span class="crayon-p"># create model with skorch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-31"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">PimaClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">criterion</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">BCELoss</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adam</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-36"><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-38"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-39"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'batch_size'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'max_epochs'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-42"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-43"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-44"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-46"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-47"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-48"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-49"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-50"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-51"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d75d413379943-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>Running this example produces the following output:</p>
<div id="urvanov-syntax-highlighter-649027db4d760770612745" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Best: 0.714844 using {'batch_size': 10, 'max_epochs': 100}
0.665365 (0.020505) with: {'batch_size': 10, 'max_epochs': 10}
0.588542 (0.168055) with: {'batch_size': 10, 'max_epochs': 50}
0.714844 (0.032369) with: {'batch_size': 10, 'max_epochs': 100}
0.671875 (0.022326) with: {'batch_size': 20, 'max_epochs': 10}
0.696615 (0.008027) with: {'batch_size': 20, 'max_epochs': 50}
0.714844 (0.019918) with: {'batch_size': 20, 'max_epochs': 100}
0.666667 (0.009744) with: {'batch_size': 40, 'max_epochs': 10}
0.687500 (0.033603) with: {'batch_size': 40, 'max_epochs': 50}
0.707031 (0.024910) with: {'batch_size': 40, 'max_epochs': 100}
0.667969 (0.014616) with: {'batch_size': 60, 'max_epochs': 10}
0.694010 (0.036966) with: {'batch_size': 60, 'max_epochs': 50}
0.694010 (0.042473) with: {'batch_size': 60, 'max_epochs': 100}
0.670573 (0.023939) with: {'batch_size': 80, 'max_epochs': 10}
0.674479 (0.020752) with: {'batch_size': 80, 'max_epochs': 50}
0.703125 (0.026107) with: {'batch_size': 80, 'max_epochs': 100}
0.680990 (0.014382) with: {'batch_size': 100, 'max_epochs': 10}
0.670573 (0.013279) with: {'batch_size': 100, 'max_epochs': 50}
0.687500 (0.017758) with: {'batch_size': 100, 'max_epochs': 100}</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d760770612745-19">19</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-1">Best: 0.714844 using {'batch_size': 10, 'max_epochs': 100}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-2">0.665365 (0.020505) with: {'batch_size': 10, 'max_epochs': 10}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-3">0.588542 (0.168055) with: {'batch_size': 10, 'max_epochs': 50}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-4">0.714844 (0.032369) with: {'batch_size': 10, 'max_epochs': 100}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-5">0.671875 (0.022326) with: {'batch_size': 20, 'max_epochs': 10}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-6">0.696615 (0.008027) with: {'batch_size': 20, 'max_epochs': 50}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-7">0.714844 (0.019918) with: {'batch_size': 20, 'max_epochs': 100}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-8">0.666667 (0.009744) with: {'batch_size': 40, 'max_epochs': 10}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-9">0.687500 (0.033603) with: {'batch_size': 40, 'max_epochs': 50}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-10">0.707031 (0.024910) with: {'batch_size': 40, 'max_epochs': 100}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-11">0.667969 (0.014616) with: {'batch_size': 60, 'max_epochs': 10}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-12">0.694010 (0.036966) with: {'batch_size': 60, 'max_epochs': 50}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-13">0.694010 (0.042473) with: {'batch_size': 60, 'max_epochs': 100}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-14">0.670573 (0.023939) with: {'batch_size': 80, 'max_epochs': 10}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-15">0.674479 (0.020752) with: {'batch_size': 80, 'max_epochs': 50}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-16">0.703125 (0.026107) with: {'batch_size': 80, 'max_epochs': 100}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-17">0.680990 (0.014382) with: {'batch_size': 100, 'max_epochs': 10}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d760770612745-18">0.670573 (0.013279) with: {'batch_size': 100, 'max_epochs': 50}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d760770612745-19">0.687500 (0.017758) with: {'batch_size': 100, 'max_epochs': 100}</div></div></td>
</tr>
</table>
</div>
</div><p>You can see that the batch size of 10 and 100 epochs achieved the best result of about 71% accuracy (but you should also take into account the accuracy&#8217;s standard deviation).</p>
<h2>How to Tune the Training Optimization Algorithm</h2>
<p>All deep learning library should offer a variety of optimization algorithms. PyTorch is no exception.</p>
<p>In this example, you will tune the optimization algorithm used to train the network, each with default parameters.</p>
<p>This is an odd example because often, you will choose one approach a priori and instead focus on tuning its parameters on your problem (see the next example).<br />
Here, you will evaluate the <a href="https://pytorch.org/docs/stable/optim.html">suite of optimization algorithms</a> available in PyTorch.</p>
<p>The full code listing is provided below:</p>
<div id="urvanov-syntax-highlighter-649027db4d763016590224" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import numpy as np
import torch
import torch.nn as nn
import torch.optim as optim
from skorch import NeuralNetClassifier
from sklearn.model_selection import GridSearchCV

# load the dataset, split into input (X) and output (y) variables
dataset = np.loadtxt('pima-indians-diabetes.csv', delimiter=',')
X = dataset[:,0:8]
y = dataset[:,8]
X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.float32).reshape(-1, 1)

# PyTorch classifier
class PimaClassifier(nn.Module):
    def __init__(self):
        super().__init__()
        self.layer = nn.Linear(8, 12)
        self.act = nn.ReLU()
        self.output = nn.Linear(12, 1)
        self.prob = nn.Sigmoid()

    def forward(self, x):
        x = self.act(self.layer(x))
        x = self.prob(self.output(x))
        return x

# create model with skorch
model = NeuralNetClassifier(
    PimaClassifier,
    criterion=nn.BCELoss,
    max_epochs=100,
    batch_size=10,
    verbose=False
)

# define the grid search parameters
param_grid = {
    'optimizer': [optim.SGD, optim.RMSprop, optim.Adagrad, optim.Adadelta,
                  optim.Adam, optim.Adamax, optim.NAdam],
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, y)

# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d763016590224-52">52</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-1"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-2"><span class="crayon-e">import </span><span class="crayon-e">torch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-3"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-4"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">optim </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">optim</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-5"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-i">GridSearchCV</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-8"><span class="crayon-p"># load the dataset, split into input (X) and output (y) variables</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-9"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">'pima-indians-diabetes.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-10"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-11"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-13"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-15"><span class="crayon-p"># PyTorch classifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-16"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-29"><span class="crayon-p"># create model with skorch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-30"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">PimaClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">criterion</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">BCELoss</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-36"><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-38"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-39"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'optimizer'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">SGD</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">RMSprop</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adagrad</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adadelta</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adam</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adamax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">NAdam</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-42"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-43"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-44"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-46"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-47"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-48"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-49"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-50"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d763016590224-51"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d763016590224-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>Running this example produces the following output:</p>
<div id="urvanov-syntax-highlighter-649027db4d766390604305" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Best: 0.721354 using {'optimizer': &lt;class 'torch.optim.adamax.Adamax'&gt;}
0.674479 (0.036828) with: {'optimizer': &lt;class 'torch.optim.sgd.SGD'&gt;}
0.700521 (0.043303) with: {'optimizer': &lt;class 'torch.optim.rmsprop.RMSprop'&gt;}
0.682292 (0.027126) with: {'optimizer': &lt;class 'torch.optim.adagrad.Adagrad'&gt;}
0.572917 (0.051560) with: {'optimizer': &lt;class 'torch.optim.adadelta.Adadelta'&gt;}
0.714844 (0.030758) with: {'optimizer': &lt;class 'torch.optim.adam.Adam'&gt;}
0.721354 (0.019225) with: {'optimizer': &lt;class 'torch.optim.adamax.Adamax'&gt;}
0.709635 (0.024360) with: {'optimizer': &lt;class 'torch.optim.nadam.NAdam'&gt;}</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d766390604305-8">8</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d766390604305-1">Best: 0.721354 using {'optimizer': &lt;class 'torch.optim.adamax.Adamax'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d766390604305-2">0.674479 (0.036828) with: {'optimizer': &lt;class 'torch.optim.sgd.SGD'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d766390604305-3">0.700521 (0.043303) with: {'optimizer': &lt;class 'torch.optim.rmsprop.RMSprop'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d766390604305-4">0.682292 (0.027126) with: {'optimizer': &lt;class 'torch.optim.adagrad.Adagrad'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d766390604305-5">0.572917 (0.051560) with: {'optimizer': &lt;class 'torch.optim.adadelta.Adadelta'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d766390604305-6">0.714844 (0.030758) with: {'optimizer': &lt;class 'torch.optim.adam.Adam'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d766390604305-7">0.721354 (0.019225) with: {'optimizer': &lt;class 'torch.optim.adamax.Adamax'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d766390604305-8">0.709635 (0.024360) with: {'optimizer': &lt;class 'torch.optim.nadam.NAdam'&gt;}</div></div></td>
</tr>
</table>
</div>
</div><p>The results suggest that the Adamax optimization algorithm is the best with a score of about 72% accuracy.</p>
<p>It is worth to mention that <code>GridSearchCV</code> will recreate your model often so every trial is independent. The reason it can be done is because of the <code>NeuralNetClassifier</code> wrapper, which knows the name of the class for your PyTorch model and instantiate one for you upon request.</p>
<h2>How to Tune Learning Rate and Momentum</h2>
<p>It is common to pre-select an optimization algorithm to train your network and tune its parameters.</p>
<p>By far, the most common optimization algorithm is plain old Stochastic Gradient Descent (SGD) because it is so well understood. In this example, you will look at optimizing the SGD learning rate and momentum parameters.</p>
<p>The learning rate controls how much to update the weight at the end of each batch, and the momentum controls how much to let the previous update influence the current weight update.</p>
<p>You will try a suite of small standard learning rates and a momentum values from 0.2 to 0.8 in steps of 0.2, as well as 0.9 (because it can be a popular value in practice). In PyTorch, the way to set the learning rate and momentum is the following:</p>
<div id="urvanov-syntax-highlighter-649027db4d769296816781" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
optimizer = optim.SGD(lr=0.001, momentum=0.9)</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d769296816781-1">1</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d769296816781-1"><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.001</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>In the skorch wrapper, you will can route the parameters to the optimizer with the prefix <code>optimizer__</code>.</p>
<p>Generally, it is a good idea to also include the number of epochs in an optimization like this as there is a dependency between the amount of learning per batch (learning rate), the number of updates per epoch (batch size), and the number of epochs.</p>
<p>The full code listing is provided below:</p>
<div id="urvanov-syntax-highlighter-649027db4d76b966720335" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import numpy as np
import torch
import torch.nn as nn
import torch.optim as optim
from skorch import NeuralNetClassifier
from sklearn.model_selection import GridSearchCV

# load the dataset, split into input (X) and output (y) variables
dataset = np.loadtxt('pima-indians-diabetes.csv', delimiter=',')
X = dataset[:,0:8]
y = dataset[:,8]
X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.float32).reshape(-1, 1)

# PyTorch classifier
class PimaClassifier(nn.Module):
    def __init__(self):
        super().__init__()
        self.layer = nn.Linear(8, 12)
        self.act = nn.ReLU()
        self.output = nn.Linear(12, 1)
        self.prob = nn.Sigmoid()

    def forward(self, x):
        x = self.act(self.layer(x))
        x = self.prob(self.output(x))
        return x

# create model with skorch
model = NeuralNetClassifier(
    PimaClassifier,
    criterion=nn.BCELoss,
    optimizer=optim.SGD,
    max_epochs=100,
    batch_size=10,
    verbose=False
)

# define the grid search parameters
param_grid = {
    'optimizer__lr': [0.001, 0.01, 0.1, 0.2, 0.3],
    'optimizer__momentum': [0.0, 0.2, 0.4, 0.6, 0.8, 0.9],
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, y)

# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76b966720335-53">53</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-1"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-2"><span class="crayon-e">import </span><span class="crayon-e">torch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-3"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-4"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">optim </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">optim</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-5"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-i">GridSearchCV</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-8"><span class="crayon-p"># load the dataset, split into input (X) and output (y) variables</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-9"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">'pima-indians-diabetes.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-10"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-11"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-13"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-15"><span class="crayon-p"># PyTorch classifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-16"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-29"><span class="crayon-p"># create model with skorch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-30"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">PimaClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">criterion</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">BCELoss</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">SGD</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-37"><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-38">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-39"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-40"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'optimizer__lr'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.001</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'optimizer__momentum'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-43"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-44"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-45"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-46">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-47"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-48"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-49"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-50"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-51"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-52"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76b966720335-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>Running this example produces the following output.</p>
<div id="urvanov-syntax-highlighter-649027db4d76e605306623" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Best: 0.682292 using {'optimizer__lr': 0.001, 'optimizer__momentum': 0.9}
0.648438 (0.016877) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.0}
0.671875 (0.017758) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.2}
0.674479 (0.022402) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.4}
0.677083 (0.011201) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.6}
0.679688 (0.027621) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.8}
0.682292 (0.026557) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.9}
0.671875 (0.019918) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.0}
0.648438 (0.024910) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.2}
0.546875 (0.143454) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.4}
0.567708 (0.153668) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.6}
0.552083 (0.141790) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.8}
0.451823 (0.144561) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.9}
0.348958 (0.001841) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.0}
0.450521 (0.142719) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.2}
0.450521 (0.142719) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.4}
0.450521 (0.142719) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.6}
0.348958 (0.001841) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.8}
0.348958 (0.001841) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.9}
0.444010 (0.136265) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.0}
0.450521 (0.142719) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.2}
0.348958 (0.001841) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.4}
0.552083 (0.141790) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.6}
0.549479 (0.142719) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.8}
0.651042 (0.001841) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.9}
0.552083 (0.141790) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.0}
0.348958 (0.001841) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.2}
0.450521 (0.142719) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.4}
0.552083 (0.141790) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.6}
0.450521 (0.142719) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.8}
0.450521 (0.142719) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.9}</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d76e605306623-31">31</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-1">Best: 0.682292 using {'optimizer__lr': 0.001, 'optimizer__momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-2">0.648438 (0.016877) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-3">0.671875 (0.017758) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-4">0.674479 (0.022402) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.4}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-5">0.677083 (0.011201) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-6">0.679688 (0.027621) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.8}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-7">0.682292 (0.026557) with: {'optimizer__lr': 0.001, 'optimizer__momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-8">0.671875 (0.019918) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-9">0.648438 (0.024910) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-10">0.546875 (0.143454) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.4}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-11">0.567708 (0.153668) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-12">0.552083 (0.141790) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.8}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-13">0.451823 (0.144561) with: {'optimizer__lr': 0.01, 'optimizer__momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-14">0.348958 (0.001841) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-15">0.450521 (0.142719) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-16">0.450521 (0.142719) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.4}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-17">0.450521 (0.142719) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-18">0.348958 (0.001841) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.8}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-19">0.348958 (0.001841) with: {'optimizer__lr': 0.1, 'optimizer__momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-20">0.444010 (0.136265) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-21">0.450521 (0.142719) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-22">0.348958 (0.001841) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.4}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-23">0.552083 (0.141790) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-24">0.549479 (0.142719) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.8}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-25">0.651042 (0.001841) with: {'optimizer__lr': 0.2, 'optimizer__momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-26">0.552083 (0.141790) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-27">0.348958 (0.001841) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-28">0.450521 (0.142719) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.4}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-29">0.552083 (0.141790) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-30">0.450521 (0.142719) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.8}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d76e605306623-31">0.450521 (0.142719) with: {'optimizer__lr': 0.3, 'optimizer__momentum': 0.9}</div></div></td>
</tr>
</table>
</div>
</div><p>You can see that, with SGD, the best results were achieved using a learning rate of 0.001 and a momentum of 0.9 with an accuracy of about 68%.</p>
<h2>How to Tune Network Weight Initialization</h2>
<p>Neural network weight initialization used to be simple: use small random values.</p>
<p>Now there is a suite of different techniques to choose from. You can get a <a href="https://pytorch.org/docs/stable/nn.init.html">laundry list from <code>torch.nn.init</code></a> documentation.</p>
<p>In this example, you will look at tuning the selection of network weight initialization by evaluating all the available techniques.</p>
<p>You will use the same weight initialization method on each layer. Ideally, it may be better to use different weight initialization schemes according to the activation function used on each layer. In the example below, you will use a rectifier for the hidden layer. Use sigmoid for the output layer because the predictions are binary. The weight initialization is implicit in PyTorch models. Therefore you need to write your own logic to initialize the weight, after the layer is created but before it is used. Let&#8217;s modify the PyTorch as follows:</p>
<div id="urvanov-syntax-highlighter-649027db4d772939561169" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# PyTorch classifier
class PimaClassifier(nn.Module):
    def __init__(self, weight_init=torch.nn.init.xavier_uniform_):
        super().__init__()
        self.layer = nn.Linear(8, 12)
        self.act = nn.ReLU()
        self.output = nn.Linear(12, 1)
        self.prob = nn.Sigmoid()
        # manually init weights
        weight_init(self.layer.weight)
        weight_init(self.output.weight)

    def forward(self, x):
        x = self.act(self.layer(x))
        x = self.prob(self.output(x))
        return x</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d772939561169-16">16</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-1"><span class="crayon-p"># PyTorch classifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-2"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weight_init</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">xavier_uniform_</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># manually init weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">weight_init</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">weight_init</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d772939561169-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d772939561169-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span></div></div></td>
</tr>
</table>
</div>
</div><p>An argument <code>weight_init</code> is added to the class <code>PimaClassifier</code> and it expects one of the initializers from <code>torch.nn.init</code>. In <code>GridSearchCV</code>, you need to use the <code>module__</code> prefix to make <code>NeuralNetClassifier</code> route the parameter to the model&#8217;s class constructor.</p>
<p>The full code listing is provided below:</p>
<div id="urvanov-syntax-highlighter-649027db4d779823601170" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import numpy as np
import torch
import torch.nn as nn
import torch.nn.init as init
import torch.optim as optim
from skorch import NeuralNetClassifier
from sklearn.model_selection import GridSearchCV

# load the dataset, split into input (X) and output (y) variables
dataset = np.loadtxt('pima-indians-diabetes.csv', delimiter=',')
X = dataset[:,0:8]
y = dataset[:,8]
X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.float32).reshape(-1, 1)

# PyTorch classifier
class PimaClassifier(nn.Module):
    def __init__(self, weight_init=init.xavier_uniform_):
        super().__init__()
        self.layer = nn.Linear(8, 12)
        self.act = nn.ReLU()
        self.output = nn.Linear(12, 1)
        self.prob = nn.Sigmoid()
        # manually init weights
        weight_init(self.layer.weight)
        weight_init(self.output.weight)

    def forward(self, x):
        x = self.act(self.layer(x))
        x = self.prob(self.output(x))
        return x

# create model with skorch
model = NeuralNetClassifier(
    PimaClassifier,
    criterion=nn.BCELoss,
    optimizer=optim.Adamax,
    max_epochs=100,
    batch_size=10,
    verbose=False
)

# define the grid search parameters
param_grid = {
    'module__weight_init': [init.uniform_, init.normal_, init.zeros_,
                           init.xavier_normal_, init.xavier_uniform_,
                           init.kaiming_normal_, init.kaiming_uniform_]
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, y)

# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d779823601170-58">58</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-1"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-2"><span class="crayon-e">import </span><span class="crayon-e">torch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-3"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-4"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">init </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">init</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-5"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">optim </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">optim</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-6"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-i">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-9"><span class="crayon-p"># load the dataset, split into input (X) and output (y) variables</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">'pima-indians-diabetes.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-11"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-12"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-14"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-16"><span class="crayon-p"># PyTorch classifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-17"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weight_init</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">xavier_uniform_</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># manually init weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">weight_init</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">weight_init</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-32">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-33"><span class="crayon-p"># create model with skorch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-34"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">PimaClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">criterion</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">BCELoss</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adamax</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-41"><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-42">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-43"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-44"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'module__weight_init'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">uniform_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">normal_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">zeros_</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">xavier_normal_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">xavier_uniform_</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">kaiming_normal_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">kaiming_uniform_</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-48"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-49"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-50"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-52"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-53"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-54"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-55"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-56"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d779823601170-57"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d779823601170-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>Running this example produces the following output.</p>
<div id="urvanov-syntax-highlighter-649027db4d77d223774616" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Best: 0.697917 using {'module__weight_init': &lt;function kaiming_uniform_ at 0x112020c10&gt;}
0.348958 (0.001841) with: {'module__weight_init': &lt;function uniform_ at 0x1120204c0&gt;}
0.602865 (0.061708) with: {'module__weight_init': &lt;function normal_ at 0x112020550&gt;}
0.652344 (0.003189) with: {'module__weight_init': &lt;function zeros_ at 0x112020820&gt;}
0.691406 (0.030758) with: {'module__weight_init': &lt;function xavier_normal_ at 0x112020af0&gt;}
0.592448 (0.171589) with: {'module__weight_init': &lt;function xavier_uniform_ at 0x112020a60&gt;}
0.563802 (0.152971) with: {'module__weight_init': &lt;function kaiming_normal_ at 0x112020ca0&gt;}
0.697917 (0.013279) with: {'module__weight_init': &lt;function kaiming_uniform_ at 0x112020c10&gt;}</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77d223774616-8">8</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-1">Best: 0.697917 using {'module__weight_init': &lt;function kaiming_uniform_ at 0x112020c10&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-2">0.348958 (0.001841) with: {'module__weight_init': &lt;function uniform_ at 0x1120204c0&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-3">0.602865 (0.061708) with: {'module__weight_init': &lt;function normal_ at 0x112020550&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-4">0.652344 (0.003189) with: {'module__weight_init': &lt;function zeros_ at 0x112020820&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-5">0.691406 (0.030758) with: {'module__weight_init': &lt;function xavier_normal_ at 0x112020af0&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-6">0.592448 (0.171589) with: {'module__weight_init': &lt;function xavier_uniform_ at 0x112020a60&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-7">0.563802 (0.152971) with: {'module__weight_init': &lt;function kaiming_normal_ at 0x112020ca0&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77d223774616-8">0.697917 (0.013279) with: {'module__weight_init': &lt;function kaiming_uniform_ at 0x112020c10&gt;}</div></div></td>
</tr>
</table>
</div>
</div><p>The best results were achieved with a He-uniform weight initialization scheme achieving a performance of about 70%.</p>
<h2>How to Tune the Neuron Activation Function</h2>
<p>The activation function controls the nonlinearity of individual neurons and when to fire.</p>
<p>Generally, the rectifier activation function is the most popular. However, it used to be the sigmoid and the tanh functions, and these functions may still be more suitable for different problems.</p>
<p>In this example, you will evaluate some of the activation functions available in PyTorch. You will only use these functions in the hidden layer, as a sigmoid activation function is required in the output for the binary classification problem. Similar to the previous example, this is an argument to the class constructor of the model, and you will use the <code>module__</code> prefix for the <code>GridSearchCV</code> parameter grid.</p>
<p>Generally, it is a good idea to prepare data to the range of the different transfer functions, which you will not do in this case.</p>
<p>The full code listing is provided below:</p>
<div id="urvanov-syntax-highlighter-649027db4d77f503897860" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import numpy as np
import torch
import torch.nn as nn
import torch.nn.init as init
import torch.optim as optim
from skorch import NeuralNetClassifier
from sklearn.model_selection import GridSearchCV

# load the dataset, split into input (X) and output (y) variables
dataset = np.loadtxt('pima-indians-diabetes.csv', delimiter=',')
X = dataset[:,0:8]
y = dataset[:,8]
X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.float32).reshape(-1, 1)

# PyTorch classifier
class PimaClassifier(nn.Module):
    def __init__(self, activation=nn.ReLU):
        super().__init__()
        self.layer = nn.Linear(8, 12)
        self.act = activation()
        self.output = nn.Linear(12, 1)
        self.prob = nn.Sigmoid()
        # manually init weights
        init.kaiming_uniform_(self.layer.weight)
        init.kaiming_uniform_(self.output.weight)

    def forward(self, x):
        x = self.act(self.layer(x))
        x = self.prob(self.output(x))
        return x

# create model with skorch
model = NeuralNetClassifier(
    PimaClassifier,
    criterion=nn.BCELoss,
    optimizer=optim.Adamax,
    max_epochs=100,
    batch_size=10,
    verbose=False
)

# define the grid search parameters
param_grid = {
    'module__activation': [nn.Identity, nn.ReLU, nn.ELU, nn.ReLU6,
                           nn.GELU, nn.Softplus, nn.Softsign, nn.Tanh,
                           nn.Sigmoid, nn.Hardsigmoid]
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, y)

# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d77f503897860-58">58</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-1"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-2"><span class="crayon-e">import </span><span class="crayon-e">torch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-3"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-4"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">init </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">init</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-5"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">optim </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">optim</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-6"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-i">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-9"><span class="crayon-p"># load the dataset, split into input (X) and output (y) variables</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">'pima-indians-diabetes.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-11"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-12"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-14"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-16"><span class="crayon-p"># PyTorch classifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-17"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">ReLU</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activation</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># manually init weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-e">kaiming_uniform_</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-e">kaiming_uniform_</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-32">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-33"><span class="crayon-p"># create model with skorch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-34"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">PimaClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">criterion</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">BCELoss</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adamax</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-41"><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-42">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-43"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-44"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'module__activation'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Identity</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">ReLU</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">ELU</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">ReLU6</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">GELU</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Softplus</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Softsign</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Tanh</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Sigmoid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Hardsigmoid</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-48"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-49"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-50"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-52"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-53"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-54"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-55"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-56"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-57"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d77f503897860-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>Running this example produces the following output.</p>
<div id="urvanov-syntax-highlighter-649027db4d783812675460" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Best: 0.699219 using {'module__activation': &lt;class 'torch.nn.modules.activation.ReLU'&gt;}
0.687500 (0.025315) with: {'module__activation': &lt;class 'torch.nn.modules.linear.Identity'&gt;}
0.699219 (0.011049) with: {'module__activation': &lt;class 'torch.nn.modules.activation.ReLU'&gt;}
0.674479 (0.035849) with: {'module__activation': &lt;class 'torch.nn.modules.activation.ELU'&gt;}
0.621094 (0.063549) with: {'module__activation': &lt;class 'torch.nn.modules.activation.ReLU6'&gt;}
0.674479 (0.017566) with: {'module__activation': &lt;class 'torch.nn.modules.activation.GELU'&gt;}
0.558594 (0.149189) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Softplus'&gt;}
0.675781 (0.014616) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Softsign'&gt;}
0.619792 (0.018688) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Tanh'&gt;}
0.643229 (0.019225) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Sigmoid'&gt;}
0.636719 (0.022326) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Hardsigmoid'&gt;}</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d783812675460-11">11</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d783812675460-1">Best: 0.699219 using {'module__activation': &lt;class 'torch.nn.modules.activation.ReLU'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d783812675460-2">0.687500 (0.025315) with: {'module__activation': &lt;class 'torch.nn.modules.linear.Identity'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d783812675460-3">0.699219 (0.011049) with: {'module__activation': &lt;class 'torch.nn.modules.activation.ReLU'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d783812675460-4">0.674479 (0.035849) with: {'module__activation': &lt;class 'torch.nn.modules.activation.ELU'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d783812675460-5">0.621094 (0.063549) with: {'module__activation': &lt;class 'torch.nn.modules.activation.ReLU6'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d783812675460-6">0.674479 (0.017566) with: {'module__activation': &lt;class 'torch.nn.modules.activation.GELU'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d783812675460-7">0.558594 (0.149189) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Softplus'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d783812675460-8">0.675781 (0.014616) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Softsign'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d783812675460-9">0.619792 (0.018688) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Tanh'&gt;}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d783812675460-10">0.643229 (0.019225) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Sigmoid'&gt;}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d783812675460-11">0.636719 (0.022326) with: {'module__activation': &lt;class 'torch.nn.modules.activation.Hardsigmoid'&gt;}</div></div></td>
</tr>
</table>
</div>
</div><p>It shows that ReLU activation function achieved the best results with an accuracy of about 70%.</p>
<h2>How to Tune Dropout Regularization</h2>
<p>In this example, you will look at tuning the <a href="https://machinelearningmastery.com/dropout-for-regularizing-deep-neural-networks/">dropout rate for regularization</a> in an effort to limit overfitting and improve the model&#8217;s ability to generalize.</p>
<p>For the best results, dropout is best combined with a weight constraint such as the max norm constraint, which is implemented in the forward pass function.</p>
<p>This involves fitting both the dropout percentage and the weight constraint. We will try dropout percentages between 0.0 and 0.9 (1.0 does not make sense) and MaxNorm weight constraint values between 0 and 5.</p>
<p>The full code listing is provided below.</p>
<div id="urvanov-syntax-highlighter-649027db4d786480082813" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import numpy as np
import torch
import torch.nn as nn
import torch.nn.init as init
import torch.optim as optim
from skorch import NeuralNetClassifier
from sklearn.model_selection import GridSearchCV

# load the dataset, split into input (X) and output (y) variables
dataset = np.loadtxt('pima-indians-diabetes.csv', delimiter=',')
X = dataset[:,0:8]
y = dataset[:,8]
X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.float32).reshape(-1, 1)

# PyTorch classifier
class PimaClassifier(nn.Module):
    def __init__(self, dropout_rate=0.5, weight_constraint=1.0):
        super().__init__()
        self.layer = nn.Linear(8, 12)
        self.act = nn.ReLU()
        self.dropout = nn.Dropout(dropout_rate)
        self.output = nn.Linear(12, 1)
        self.prob = nn.Sigmoid()
        self.weight_constraint = weight_constraint
        # manually init weights
        init.kaiming_uniform_(self.layer.weight)
        init.kaiming_uniform_(self.output.weight)

    def forward(self, x):
        # maxnorm weight before actual forward pass
        with torch.no_grad():
            norm = self.layer.weight.norm(2, dim=0, keepdim=True).clamp(min=self.weight_constraint / 2)
            desired = torch.clamp(norm, max=self.weight_constraint)
            self.layer.weight *= (desired / norm)
        # actual forward pass
        x = self.act(self.layer(x))
        x = self.dropout(x)
        x = self.prob(self.output(x))
        return x

# create model with skorch
model = NeuralNetClassifier(
    PimaClassifier,
    criterion=nn.BCELoss,
    optimizer=optim.Adamax,
    max_epochs=100,
    batch_size=10,
    verbose=False
)

# define the grid search parameters
param_grid = {
    'module__weight_constraint': [1.0, 2.0, 3.0, 4.0, 5.0],
    'module__dropout_rate': [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, y)

# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d786480082813-66">66</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-1"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-2"><span class="crayon-e">import </span><span class="crayon-e">torch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-3"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-4"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">init </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">init</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-5"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">optim </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">optim</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-6"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-i">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-9"><span class="crayon-p"># load the dataset, split into input (X) and output (y) variables</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">'pima-indians-diabetes.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-11"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-12"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-14"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-16"><span class="crayon-p"># PyTorch classifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-17"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weight_constraint</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">dropout</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">weight_constraint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weight</span><span class="crayon-sy">_</span>constraint</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># manually init weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-e">kaiming_uniform_</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-e">kaiming_uniform_</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># maxnorm weight before actual forward pass</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">with </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">no_grad</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dim</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdim</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">clamp</span><span class="crayon-sy">(</span><span class="crayon-v">min</span><span class="crayon-o">=</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">weight_constraint</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">desired</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">clamp</span><span class="crayon-sy">(</span><span class="crayon-v">norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max</span><span class="crayon-o">=</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">weight_constraint</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-e ">weight *</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">desired</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">norm</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># actual forward pass</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">dropout</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-42"><span class="crayon-p"># create model with skorch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-43"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">PimaClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">criterion</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">BCELoss</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adamax</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-50"><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-52"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-53"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'module__weight_constraint'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5.0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'module__dropout_rate'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-56"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-57"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-58"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-60"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-61"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-62"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-63"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-64"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d786480082813-65"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d786480082813-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>Running this example produces the following output.</p>
<div id="urvanov-syntax-highlighter-649027db4d78a560414612" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Best: 0.701823 using {'module__dropout_rate': 0.1, 'module__weight_constraint': 2.0}
0.669271 (0.015073) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 1.0}
0.692708 (0.035132) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 2.0}
0.589844 (0.170180) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 3.0}
0.561198 (0.151131) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 4.0}
0.688802 (0.021710) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 5.0}
0.697917 (0.009744) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 1.0}
0.701823 (0.016367) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 2.0}
0.694010 (0.010253) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 3.0}
0.686198 (0.025976) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 4.0}
0.679688 (0.026107) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 5.0}
0.701823 (0.029635) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 1.0}
0.682292 (0.014731) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 2.0}
0.701823 (0.009744) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 3.0}
0.701823 (0.026557) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 4.0}
0.687500 (0.015947) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 5.0}
0.686198 (0.006639) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 1.0}
0.656250 (0.006379) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 2.0}
0.565104 (0.155608) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 3.0}
0.700521 (0.028940) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 4.0}
0.669271 (0.012890) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 5.0}
0.661458 (0.018688) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 1.0}
0.669271 (0.017566) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 2.0}
0.652344 (0.006379) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 3.0}
0.680990 (0.037783) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 4.0}
0.692708 (0.042112) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 5.0}
0.666667 (0.006639) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 1.0}
0.652344 (0.011500) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 2.0}
0.662760 (0.007366) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 3.0}
0.558594 (0.146610) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 4.0}
0.552083 (0.141826) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 5.0}
0.548177 (0.141826) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 1.0}
0.653646 (0.013279) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 2.0}
0.661458 (0.008027) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 3.0}
0.553385 (0.142719) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 4.0}
0.669271 (0.035132) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 5.0}
0.662760 (0.015733) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 1.0}
0.636719 (0.024910) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 2.0}
0.550781 (0.146818) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 3.0}
0.537760 (0.140094) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 4.0}
0.542969 (0.138144) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 5.0}
0.565104 (0.148654) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 1.0}
0.657552 (0.008027) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 2.0}
0.428385 (0.111418) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 3.0}
0.549479 (0.142719) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 4.0}
0.648438 (0.005524) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 5.0}
0.540365 (0.136861) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 1.0}
0.605469 (0.053083) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 2.0}
0.553385 (0.139948) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 3.0}
0.549479 (0.142719) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 4.0}
0.595052 (0.075566) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 5.0}</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78a560414612-51">51</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-1">Best: 0.701823 using {'module__dropout_rate': 0.1, 'module__weight_constraint': 2.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-2">0.669271 (0.015073) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 1.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-3">0.692708 (0.035132) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 2.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-4">0.589844 (0.170180) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 3.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-5">0.561198 (0.151131) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 4.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-6">0.688802 (0.021710) with: {'module__dropout_rate': 0.0, 'module__weight_constraint': 5.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-7">0.697917 (0.009744) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 1.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-8">0.701823 (0.016367) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 2.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-9">0.694010 (0.010253) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 3.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-10">0.686198 (0.025976) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 4.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-11">0.679688 (0.026107) with: {'module__dropout_rate': 0.1, 'module__weight_constraint': 5.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-12">0.701823 (0.029635) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 1.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-13">0.682292 (0.014731) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 2.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-14">0.701823 (0.009744) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 3.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-15">0.701823 (0.026557) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 4.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-16">0.687500 (0.015947) with: {'module__dropout_rate': 0.2, 'module__weight_constraint': 5.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-17">0.686198 (0.006639) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 1.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-18">0.656250 (0.006379) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 2.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-19">0.565104 (0.155608) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 3.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-20">0.700521 (0.028940) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 4.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-21">0.669271 (0.012890) with: {'module__dropout_rate': 0.3, 'module__weight_constraint': 5.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-22">0.661458 (0.018688) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 1.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-23">0.669271 (0.017566) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 2.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-24">0.652344 (0.006379) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 3.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-25">0.680990 (0.037783) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 4.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-26">0.692708 (0.042112) with: {'module__dropout_rate': 0.4, 'module__weight_constraint': 5.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-27">0.666667 (0.006639) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 1.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-28">0.652344 (0.011500) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 2.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-29">0.662760 (0.007366) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 3.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-30">0.558594 (0.146610) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 4.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-31">0.552083 (0.141826) with: {'module__dropout_rate': 0.5, 'module__weight_constraint': 5.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-32">0.548177 (0.141826) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 1.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-33">0.653646 (0.013279) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 2.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-34">0.661458 (0.008027) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 3.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-35">0.553385 (0.142719) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 4.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-36">0.669271 (0.035132) with: {'module__dropout_rate': 0.6, 'module__weight_constraint': 5.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-37">0.662760 (0.015733) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 1.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-38">0.636719 (0.024910) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 2.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-39">0.550781 (0.146818) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 3.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-40">0.537760 (0.140094) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 4.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-41">0.542969 (0.138144) with: {'module__dropout_rate': 0.7, 'module__weight_constraint': 5.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-42">0.565104 (0.148654) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 1.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-43">0.657552 (0.008027) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 2.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-44">0.428385 (0.111418) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 3.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-45">0.549479 (0.142719) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 4.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-46">0.648438 (0.005524) with: {'module__dropout_rate': 0.8, 'module__weight_constraint': 5.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-47">0.540365 (0.136861) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 1.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-48">0.605469 (0.053083) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 2.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-49">0.553385 (0.139948) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 3.0}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-50">0.549479 (0.142719) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 4.0}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78a560414612-51">0.595052 (0.075566) with: {'module__dropout_rate': 0.9, 'module__weight_constraint': 5.0}</div></div></td>
</tr>
</table>
</div>
</div><p>You can see that the dropout rate of 10% and the weight constraint of 2.0 resulted in the best accuracy of about 70%.</p>
<h2>How to Tune the Number of Neurons in the Hidden Layer</h2>
<p>The number of neurons in a layer is an important parameter to tune. Generally the number of neurons in a layer controls the representational capacity of the network, at least at that point in the topology.</p>
<p>Generally, a large enough single layer network can approximate any other neural network, due to the <a href="https://en.wikipedia.org/wiki/Universal_approximation_theorem">universal approximation theorem</a>.</p>
<p>In this example, you will look at tuning the number of neurons in a single hidden layer. you will try values from 1 to 30 in steps of 5.<br />
A larger network requires more training and at least the batch size and number of epochs should ideally be optimized with the number of neurons.</p>
<p>The full code listing is provided below.</p>
<div id="urvanov-syntax-highlighter-649027db4d78f779554467" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import numpy as np
import torch
import torch.nn as nn
import torch.nn.init as init
import torch.optim as optim
from skorch import NeuralNetClassifier
from sklearn.model_selection import GridSearchCV

# load the dataset, split into input (X) and output (y) variables
dataset = np.loadtxt('pima-indians-diabetes.csv', delimiter=',')
X = dataset[:,0:8]
y = dataset[:,8]
X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.float32).reshape(-1, 1)

class PimaClassifier(nn.Module):
    def __init__(self, n_neurons=12):
        super().__init__()
        self.layer = nn.Linear(8, n_neurons)
        self.act = nn.ReLU()
        self.dropout = nn.Dropout(0.1)
        self.output = nn.Linear(n_neurons, 1)
        self.prob = nn.Sigmoid()
        self.weight_constraint = 2.0
        # manually init weights
        init.kaiming_uniform_(self.layer.weight)
        init.kaiming_uniform_(self.output.weight)

    def forward(self, x):
        # maxnorm weight before actual forward pass
        with torch.no_grad():
            norm = self.layer.weight.norm(2, dim=0, keepdim=True).clamp(min=self.weight_constraint / 2)
            desired = torch.clamp(norm, max=self.weight_constraint)
            self.layer.weight *= (desired / norm)
        # actual forward pass
        x = self.act(self.layer(x))
        x = self.dropout(x)
        x = self.prob(self.output(x))
        return x

# create model with skorch
model = NeuralNetClassifier(
    PimaClassifier,
    criterion=nn.BCELoss,
    optimizer=optim.Adamax,
    max_epochs=100,
    batch_size=10,
    verbose=False
)

# define the grid search parameters
param_grid = {
    'module__n_neurons': [1, 5, 10, 15, 20, 25, 30]
}
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=3)
grid_result = grid.fit(X, y)

# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d78f779554467-64">64</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-1"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-2"><span class="crayon-e">import </span><span class="crayon-e">torch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-3"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">nn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">nn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-4"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">init </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">init</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-5"><span class="crayon-e">import </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">optim </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">optim</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-6"><span class="crayon-e">from </span><span class="crayon-e">skorch </span><span class="crayon-e">import </span><span class="crayon-e">NeuralNetClassifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-i">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-9"><span class="crayon-p"># load the dataset, split into input (X) and output (y) variables</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">'pima-indians-diabetes.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-11"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-12"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-14"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">tensor</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-16"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PimaClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">Module</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_neurons</span><span class="crayon-o">=</span><span class="crayon-cn">12</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_neurons</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">act</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">ReLU</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">dropout</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Linear</span><span class="crayon-sy">(</span><span class="crayon-v">n_neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-e">Sigmoid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">weight_constraint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># manually init weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-e">kaiming_uniform_</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-e">kaiming_uniform_</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">output</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># maxnorm weight before actual forward pass</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">with </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">no_grad</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-v">weight</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dim</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdim</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">clamp</span><span class="crayon-sy">(</span><span class="crayon-v">min</span><span class="crayon-o">=</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">weight_constraint</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">desired</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">torch</span><span class="crayon-sy">.</span><span class="crayon-e">clamp</span><span class="crayon-sy">(</span><span class="crayon-v">norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max</span><span class="crayon-o">=</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">weight_constraint</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-e ">weight *</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">desired</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">norm</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># actual forward pass</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">act</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">layer</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">dropout</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-41"><span class="crayon-p"># create model with skorch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-42"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">NeuralNetClassifier</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">PimaClassifier</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">criterion</span><span class="crayon-o">=</span><span class="crayon-v">nn</span><span class="crayon-sy">.</span><span class="crayon-v">BCELoss</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optim</span><span class="crayon-sy">.</span><span class="crayon-v">Adamax</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-49"><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-50">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-51"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-52"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'module__n_neurons'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-54"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-55"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-56"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-57">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-58"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-59"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-60"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-61"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-62"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-63"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d78f779554467-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div><p>Running this example produces the following output.</p>
<div id="urvanov-syntax-highlighter-649027db4d793573014582" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Best: 0.708333 using {'module__n_neurons': 30}
0.654948 (0.003683) with: {'module__n_neurons': 1}
0.666667 (0.023073) with: {'module__n_neurons': 5}
0.694010 (0.014382) with: {'module__n_neurons': 10}
0.682292 (0.014382) with: {'module__n_neurons': 15}
0.707031 (0.028705) with: {'module__n_neurons': 20}
0.703125 (0.030758) with: {'module__n_neurons': 25}
0.708333 (0.015733) with: {'module__n_neurons': 30}</textarea></div>
<div class="urvanov-syntax-highlighter-main" style="">
<table class="crayon-table">
<tr class="urvanov-syntax-highlighter-row">
<td class="crayon-nums " data-settings="show">
<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-649027db4d793573014582-8">8</div></div>
</td>
<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d793573014582-1">Best: 0.708333 using {'module__n_neurons': 30}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d793573014582-2">0.654948 (0.003683) with: {'module__n_neurons': 1}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d793573014582-3">0.666667 (0.023073) with: {'module__n_neurons': 5}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d793573014582-4">0.694010 (0.014382) with: {'module__n_neurons': 10}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d793573014582-5">0.682292 (0.014382) with: {'module__n_neurons': 15}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d793573014582-6">0.707031 (0.028705) with: {'module__n_neurons': 20}</div><div class="crayon-line" id="urvanov-syntax-highlighter-649027db4d793573014582-7">0.703125 (0.030758) with: {'module__n_neurons': 25}</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-649027db4d793573014582-8">0.708333 (0.015733) with: {'module__n_neurons': 30}</div></div></td>
</tr>
</table>
</div>
</div><p>You can see that the best results were achieved with a network with 30 neurons in the hidden layer with an accuracy of about 71%.</p>
<h2>Tips for Hyperparameter Optimization</h2>
<p>This section lists some handy tips to consider when tuning hyperparameters of your neural network.</p>
<ul>
<li><strong>$k$-Fold Cross-Validation</strong>. You can see that the results from the examples in this post show some variance. A default cross-validation of 3 was used, but perhaps $k=5$ or $k=10$ would be more stable. Carefully choose your cross-validation configuration to ensure your results are stable.</li>
<li><strong>Review the Whole Grid</strong>. Do not just focus on the best result, review the whole grid of results and look for trends to support configuration decisions. Of course, there will be more combinations and it takes a longer time to evaluate.</li>
<li><strong>Parallelize</strong>. Use all your cores if you can, neural networks are slow to train and we often want to try a lot of different parameters. Consider to run it on a cloud platform, such as AWS.</li>
<li><strong>Use a Sample of Your Dataset</strong>. Because networks are slow to train, try training them on a smaller sample of your training dataset, just to get an idea of general directions of parameters rather than optimal configurations.</li>
<li><strong>Start with Coarse Grids</strong>. Start with coarse-grained grids and zoom into finer grained grids once you can narrow the scope.</li>
<li><strong>Do Not Transfer Results</strong>. Results are generally problem specific. Try to avoid favorite configurations on each new problem that you see. It is unlikely that optimal results you discover on one problem will transfer to your next project. Instead look for broader trends like number of layers or relationships between parameters.</li>
<li><strong>Reproducibility is a Problem</strong>. Although we set the seed for the random number generator in NumPy, the results are not 100% reproducible. There is more to reproducibility when grid searching wrapped PyTorch models than is presented in this post.</li>
</ul>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<ul>
<li><a href="https://skorch.readthedocs.io/en/latest/">skorch</a> documentation</li>
<li><a href="https://pytorch.org/docs/stable/nn.html">torch.nn</a> from PyTorch</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">GridSearchCV</a> from scikit-learn</li>
</ul>
<h2>Summary</h2>
<p>In this post, you discovered how you can tune the hyperparameters of your deep learning networks in Python using PyTorch and scikit-learn.<br />
Specifically, you learned:</p>
<ul>
<li>How to wrap PyTorch models for use in scikit-learn and how to use grid search.</li>
<li>How to grid search a suite of different standard neural network parameters for PyTorch models.</li>
<li>How to design your own hyperparameter optimization experiments.</li>
</ul>
<div class="widget_text awac-wrapper" id="custom_html-116"><div class="widget_text awac widget custom_html-116"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Get Started on Deep Learning with PyTorch!</h2>
<a href="/deep-learning-with-pytorch/"><img width="220" height="293" style="border: 0;" src="https://machinelearningmastery.com/wp-content/uploads/2023/03/DLWPT-220.jpg" alt="Deep Learning with PyTorch" align="left" /></a>
<h4>Learn how to build deep learning models</h4>
<p>...using the newly released PyTorch 2.0 library</p>
<p>Discover how in my new Ebook:<br>
<a href="/deep-learning-with-pytorch/">Deep Learning with PyTorch</a></p>
<p>It provides <strong>self-study tutorials</strong> with <strong>hundreds of working code</strong> to turn you from a novice to expert. It equips you with<br>
<em>tensor operation</em>, <em>training</em>, <em>evaluation</em>, <em>hyperparameter optimization</em>,
and much more...</p>
<h4>Kick-start your deep learning journey with hands-on exercises</h4>
<br>
<p><a href="/deep-learning-with-pytorch/" class="woo-sc-button  red"><span class="woo-">See What's Inside</span></a></p>
<div class="woo-sc-hr"></div>
</div>
</div></div></div></p><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-14630 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" rel="nofollow" target="_blank" data-href="https://twitter.com/intent/tweet?text=How+to+Grid+Search+Hyperparameters+for+PyTorch+Models&url=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z" /><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" /></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_tweet-icon" rel="nofollow" target="_blank" data-href="https://twitter.com/intent/tweet?text=How+to+Grid+Search+Hyperparameters+for+PyTorch+Models&url=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z" /><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" /></svg></span><i class="simplesocialtxt">Tweet </i></button> <button class="ssb_fbshare-icon" rel="nofollow" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" rel="nofollow" target="_blank" data-href="https://www.linkedin.com/sharing/share-offsite/?url=https://machinelearningmastery.com/how-to-grid-search-hyperparameters-for-pytorch-models/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-73c9f148f6d44e5e000b4ea0-="">
<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" /> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" /> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" /> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
</div>
<div class="crp_related  "><h3>More On This Topic</h3><ul><li><a href="https://machinelearningmastery.com/hyperparameter-optimization-with-random-search-and-grid-search/" class="crp_link post-10504"><figure><img loading="lazy" width="150" height="100" src="https://machinelearningmastery.com/wp-content/uploads/2020/06/Hyperparameter-Optimization-With-Random-Search-and-Grid-Search.jpg" class="crp_thumb crp_featured" alt="Hyperparameter Optimization With Random Search and Grid Search" title="Hyperparameter Optimization With Random Search and Grid Search" srcset="https://machinelearningmastery.com/wp-content/uploads/2020/06/Hyperparameter-Optimization-With-Random-Search-and-Grid-Search.jpg 800w, https://machinelearningmastery.com/wp-content/uploads/2020/06/Hyperparameter-Optimization-With-Random-Search-and-Grid-Search-300x200.jpg 300w, https://machinelearningmastery.com/wp-content/uploads/2020/06/Hyperparameter-Optimization-With-Random-Search-and-Grid-Search-768x511.jpg 768w" sizes="(max-width: 150px) 100vw, 150px" srcset="https://machinelearningmastery.com/wp-content/uploads/2020/06/Hyperparameter-Optimization-With-Random-Search-and-Grid-Search.jpg 800w, https://machinelearningmastery.com/wp-content/uploads/2020/06/Hyperparameter-Optimization-With-Random-Search-and-Grid-Search-300x200.jpg 300w, https://machinelearningmastery.com/wp-content/uploads/2020/06/Hyperparameter-Optimization-With-Random-Search-and-Grid-Search-768x511.jpg 768w" /></figure><span class="crp_title">Hyperparameter Optimization With Random Search and&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/" class="crp_link post-6441"><figure><img loading="lazy" width="150" height="84" src="https://machinelearningmastery.com/wp-content/uploads/2018/11/How-to-Grid-Search-Deep-Learning-Models-for-Time-Series-Forecasting.jpg" class="crp_thumb crp_featured" alt="How to Grid Search Deep Learning Models for Time Series Forecasting" title="How to Grid Search Deep Learning Models for Time Series Forecasting" srcset="https://machinelearningmastery.com/wp-content/uploads/2018/11/How-to-Grid-Search-Deep-Learning-Models-for-Time-Series-Forecasting.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2018/11/How-to-Grid-Search-Deep-Learning-Models-for-Time-Series-Forecasting-300x169.jpg 300w" sizes="(max-width: 150px) 100vw, 150px" srcset="https://machinelearningmastery.com/wp-content/uploads/2018/11/How-to-Grid-Search-Deep-Learning-Models-for-Time-Series-Forecasting.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2018/11/How-to-Grid-Search-Deep-Learning-Models-for-Time-Series-Forecasting-300x169.jpg 300w" /></figure><span class="crp_title">How to Grid Search Deep Learning Models for Time&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/how-to-grid-search-sarima-model-hyperparameters-for-time-series-forecasting-in-python/" class="crp_link post-6357"><figure><img loading="lazy" width="150" height="79" src="https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset.png" class="crp_thumb crp_featured" alt="How to Grid Search SARIMA Hyperparameters for Time Series Forecasting" title="How to Grid Search SARIMA Hyperparameters for Time Series Forecasting" srcset="https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset.png 1454w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset-300x158.png 300w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset-768x405.png 768w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset-1024x539.png 1024w" sizes="(max-width: 150px) 100vw, 150px" srcset="https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset.png 1454w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset-300x158.png 300w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset-768x405.png 768w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Mean-Temperatures-Dataset-1024x539.png 1024w" /></figure><span class="crp_title">How to Grid Search SARIMA Hyperparameters for Time&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" class="crp_link post-2967"><figure><img loading="lazy" width="150" height="84" src="https://machinelearningmastery.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras.jpg" class="crp_thumb crp_featured" alt="How to Grid Search Hyperparameters for Deep Learning Models in Python with Keras" title="How to Grid Search Hyperparameters for Deep Learning Models in Python with Keras" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-300x168.jpg 300w" sizes="(max-width: 150px) 100vw, 150px" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-300x168.jpg 300w" /></figure><span class="crp_title">How to Grid Search Hyperparameters for Deep Learning&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/manually-optimize-hyperparameters/" class="crp_link post-11950"><figure><img loading="lazy" width="150" height="100" src="https://machinelearningmastery.com/wp-content/uploads/2021/03/How-to-Manually-Optimize-Machine-Learning-Model-Hyperparameters.jpg" class="crp_thumb crp_featured" alt="How to Manually Optimize Machine Learning Model Hyperparameters" title="How to Manually Optimize Machine Learning Model Hyperparameters" srcset="https://machinelearningmastery.com/wp-content/uploads/2021/03/How-to-Manually-Optimize-Machine-Learning-Model-Hyperparameters.jpg 799w, https://machinelearningmastery.com/wp-content/uploads/2021/03/How-to-Manually-Optimize-Machine-Learning-Model-Hyperparameters-300x200.jpg 300w, https://machinelearningmastery.com/wp-content/uploads/2021/03/How-to-Manually-Optimize-Machine-Learning-Model-Hyperparameters-768x512.jpg 768w" sizes="(max-width: 150px) 100vw, 150px" srcset="https://machinelearningmastery.com/wp-content/uploads/2021/03/How-to-Manually-Optimize-Machine-Learning-Model-Hyperparameters.jpg 799w, https://machinelearningmastery.com/wp-content/uploads/2021/03/How-to-Manually-Optimize-Machine-Learning-Model-Hyperparameters-300x200.jpg 300w, https://machinelearningmastery.com/wp-content/uploads/2021/03/How-to-Manually-Optimize-Machine-Learning-Model-Hyperparameters-768x512.jpg 768w" /></figure><span class="crp_title">How to Manually Optimize Machine Learning Model&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/how-to-grid-search-triple-exponential-smoothing-for-time-series-forecasting-in-python/" class="crp_link post-6340"><figure><img loading="lazy" width="150" height="79" src="https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset.png" class="crp_thumb crp_featured" alt="How to Grid Search Triple Exponential Smoothing for Time Series Forecasting in Python" title="How to Grid Search Triple Exponential Smoothing for Time Series Forecasting in Python" srcset="https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset.png 1462w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset-300x158.png 300w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset-768x403.png 768w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset-1024x538.png 1024w" sizes="(max-width: 150px) 100vw, 150px" srcset="https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset.png 1462w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset-300x158.png 300w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset-768x403.png 768w, https://machinelearningmastery.com/wp-content/uploads/2018/07/Line-Plot-of-the-Monthly-Car-Sales-Dataset-1024x538.png 1024w" /></figure><span class="crp_title">How to Grid Search Triple Exponential Smoothing for&hellip;</span></a></li></ul><div class="crp_clear"></div></div> </section>
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img src="https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=80&#038;d=mm&#038;r=g" width="80" height="80" alt="Avatar" class="avatar avatar-80 wp-user-avatar wp-user-avatar-80 photo avatar-default" /></div>
<div class="profile-content">
<h4>About Adrian Tam</h4>
Adrian Tam, PhD is a data scientist and software engineer. <div class="profile-link">
<a href="https://machinelearningmastery.com/author/adriantam/">
View all posts by Adrian Tam <span class="meta-nav">&rarr;</span> </a>
</div>
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article>
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/use-pytorch-deep-learning-models-with-scikit-learn/" rel="prev"><i class="fa fa-angle-left"></i> Use PyTorch Deep Learning Models with scikit-learn</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/save-and-load-your-pytorch-models/" rel="next">Save and Load Your PyTorch Models <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"><h5 class="nocomments">No comments yet.</h5></div> <div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/how-to-grid-search-hyperparameters-for-pytorch-models/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment <span class="required">*</span></label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required='true' /><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required='true' /><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment" /> <input type='hidden' name='comment_post_ID' value='14630' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="243d2cb872" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="164" /><script type="rocketlazyloadscript">document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form> </div>
</section>
<aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=88&#038;d=mm&#038;r=g" width="88" height="88" alt="Avatar" class="avatar avatar-88 wp-user-avatar wp-user-avatar-88 photo avatar-default" /></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_linkedin3.png" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_twitter3.png" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_facebook3.png" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="/newsletter/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_email3.png" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_rss3.png" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-103" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div id="right-sidebar" class="widget" style="height:260px;">
</div></div></div><div id="custom_html-117" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/pytorch-tutorial-develop-deep-learning-models/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2020/03/PyTorch-Tutorial-How-to-Develop-Deep-Learning-Models-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="PyTorch Tutorial - How to Develop Deep Learning Models" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/pytorch-tutorial-develop-deep-learning-models/" rel="nofollow">PyTorch Tutorial: How to Develop Deep Learning Models with Python</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/calculating-derivatives-in-pytorch/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2022/01/jossuha-theophile-H-CZjCQfsFw-unsplash-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/calculating-derivatives-in-pytorch/" rel="nofollow">Calculating Derivatives in PyTorch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/building-an-image-classifier-with-a-single-layer-neural-network-in-pytorch/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2023/01/alex-fung-sKnJ84lF0gY-unsplash-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/building-an-image-classifier-with-a-single-layer-neural-network-in-pytorch/" rel="nofollow">Building an Image Classifier with a Single-Layer Neural Network in PyTorch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/lstm-for-time-series-prediction-in-pytorch/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2023/02/carry-kung-5W5Fb6bHOQc-unsplash-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/lstm-for-time-series-prediction-in-pytorch/" rel="nofollow">LSTM for Time Series Prediction in PyTorch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/building-a-regression-model-in-pytorch/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2023/01/sam-deng-2bJGj7sIclQ-unsplash-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/building-a-regression-model-in-pytorch/" rel="nofollow">Building a Regression Model in PyTorch</a></div></div></div></div><div id="custom_html-115" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<p><h4>Loving the Tutorials?</h4></p>
<p>The <a href="/deep-learning-with-pytorch/">Deep Learning with PyTorch
</a> EBook<br> is where you'll find the <strong><i>Really Good</i></strong> stuff.</p>
<p>
<a href="/deep-learning-with-pytorch/" class="woo-sc-button  red"><span class="woo-">&gt;&gt; See What's Inside</span></a>
</p>
</div></div></div></aside>
</div>
</div>
<footer id="footer" class="col-full">
<div id="copyright" class="col-left">
<p>© 2023 <a href="https://www.guidingtechmedia.com/">Guiding Tech Media</a>. All Rights Reserved.<br />
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="/newsletter/">Newsletter</a> |
<a href="/rss-feed/">RSS</a></p> </div>
<div id="credit" class="col-right">
<p><a href="/privacy/">Privacy</a> |
<a href="/disclaimer/">Disclaimer</a> |
<a href="/terms-of-service/">Terms</a> |
<a href="/contact/">Contact</a> |
<a href="/sitemap.xml">Sitemap</a> |
<a href="/site-search/">Search</a></p> </div>
</footer>
</div>
</div>
<div class="fix"></div>
<script data-no-optimize='1' data-cfasync='false' id='cls-insertion-7025d0b'>'use strict';(function(){function y(c,a){function b(){this.constructor=c}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");R(c,a);c.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}function I(c,a,b,d){var e=arguments.length,f=3>e?a:null===d?d=Object.getOwnPropertyDescriptor(a,b):d,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(c,a,b,d);else for(var h=c.length-1;0<=h;h--)if(g=
c[h])f=(3>e?g(f):3<e?g(a,b,f):g(a,b))||f;return 3<e&&f&&Object.defineProperty(a,b,f),f}function C(c,a){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(c,a)}function K(c){var a="function"===typeof Symbol&&Symbol.iterator,b=a&&c[a],d=0;if(b)return b.call(c);if(c&&"number"===typeof c.length)return{next:function(){c&&d>=c.length&&(c=void 0);return{value:c&&c[d++],done:!c}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.");}function p(c,
a){var b="function"===typeof Symbol&&c[Symbol.iterator];if(!b)return c;c=b.call(c);var d,e=[];try{for(;(void 0===a||0<a--)&&!(d=c.next()).done;)e.push(d.value)}catch(g){var f={error:g}}finally{try{d&&!d.done&&(b=c["return"])&&b.call(c)}finally{if(f)throw f.error;}}return e}function w(c,a,b){if(b||2===arguments.length)for(var d=0,e=a.length,f;d<e;d++)!f&&d in a||(f||(f=Array.prototype.slice.call(a,0,d)),f[d]=a[d]);return c.concat(f||Array.prototype.slice.call(a))}window.adthriveCLS.buildDate="2023-06-16";
var R=function(c,a){R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,d){b.__proto__=d}||function(b,d){for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])};return R(c,a)},x=function(){x=Object.assign||function(c){for(var a,b=1,d=arguments.length;b<d;b++){a=arguments[b];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(c[e]=a[e])}return c};return x.apply(this,arguments)},n=new (function(){function c(){}c.prototype.info=function(a,b){for(var d=[],e=2;e<arguments.length;e++)d[e-
2]=arguments[e];this.call.apply(this,w([console.info,a,b],p(d),!1))};c.prototype.warn=function(a,b){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];this.call.apply(this,w([console.warn,a,b],p(d),!1))};c.prototype.error=function(a,b){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];this.call.apply(this,w([console.error,a,b],p(d),!1));this.sendErrorLogToCommandQueue.apply(this,w([a,b],p(d),!1))};c.prototype.event=function(a,b){for(var d,e=2;e<arguments.length;e++);"debug"===(null===
(d=window.adthriveCLS)||void 0===d?void 0:d.bucket)&&this.info(a,b)};c.prototype.sendErrorLogToCommandQueue=function(a,b){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];window.adthrive=window.adthrive||{};window.adthrive.cmd=window.adthrive.cmd||[];window.adthrive.cmd.push(function(){void 0!==window.adthrive.logError&&"function"===typeof window.adthrive.logError&&window.adthrive.logError(a,b,d)}.bind(a,b,d))};c.prototype.call=function(a,b,d){for(var e=[],f=3;f<arguments.length;f++)e[f-
3]=arguments[f];f=["%c".concat(b,"::").concat(d," ")];var g=["color: #999; font-weight: bold;"];0<e.length&&"string"===typeof e[0]&&f.push(e.shift());g.push.apply(g,w([],p(e),!1));try{Function.prototype.apply.call(a,console,w([f.join("")],p(g),!1))}catch(h){console.error(h)}};return c}()),u=function(c,a){return null==c||c!==c?a:c},la=function(c){var a=c.clientWidth;getComputedStyle&&(c=getComputedStyle(c,null),a-=parseFloat(c.paddingLeft||"0")+parseFloat(c.paddingRight||"0"));return a},ma=function(c){var a=
c.offsetHeight,b=c.offsetWidth,d=c.getBoundingClientRect(),e=document.body,f=document.documentElement;c=Math.round(d.top+(window.pageYOffset||f.scrollTop||e.scrollTop)-(f.clientTop||e.clientTop||0));d=Math.round(d.left+(window.pageXOffset||f.scrollLeft||e.scrollLeft)-(f.clientLeft||e.clientLeft||0));return{top:c,left:d,bottom:c+a,right:d+b,width:b,height:a}},L=function(){var c=navigator.userAgent,a=/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari/i.test(c);return/Mobi|iP(hone|od)|Opera Mini/i.test(c)&&
!a},na=function(c){void 0===c&&(c=document);return(c===document?document.body:c).getBoundingClientRect().top},oa=function(c){return c.includes(",")?c.split(","):[c]},pa=function(c){void 0===c&&(c=document);c=c.querySelectorAll("article");return 0===c.length?null:(c=Array.from(c).reduce(function(a,b){return b.offsetHeight>a.offsetHeight?b:a}))&&c.offsetHeight>1.5*window.innerHeight?c:null},qa=function(c,a,b){void 0===b&&(b=document);var d=pa(b),e=d?[d]:[],f=[];c.forEach(function(h){var l=Array.from(b.querySelectorAll(h.elementSelector)).slice(0,
h.skip);oa(h.elementSelector).forEach(function(k){var m=b.querySelectorAll(k);k=function(t){var q=m[t];if(a.map.some(function(B){return B.el.isEqualNode(q)}))return"continue";(t=q&&q.parentElement)&&t!==document.body?e.push(t):e.push(q);-1===l.indexOf(q)&&f.push({dynamicAd:h,element:q})};for(var r=0;r<m.length;r++)k(r)})});var g=na(b);c=f.sort(function(h,l){return h.element.getBoundingClientRect().top-g-(l.element.getBoundingClientRect().top-g)});return[e,c]},ra=function(c,a,b){void 0===b&&(b=document);
a=p(qa(c,a,b),2);c=a[0];a=a[1];if(0===c.length)throw Error("No Main Content Elements Found");return[Array.from(c).reduce(function(d,e){return e.offsetHeight>d.offsetHeight?e:d})||document.body,a]},z;(function(c){c.ThirtyThreeAcross="33across";c.AppNexus="appnexus";c.Amazon="amazon";c.Colossus="colossus";c.ColossusServer="col_ss";c.Conversant="conversant";c.Concert="concert";c.Criteo="criteo";c.GumGum="gumgum";c.IndexExchange="ix";c.Kargo="kargo";c.KargoServer="krgo_ss";c.MediaGrid="grid";c.MediaGridVideo=
"gridvid";c.Nativo="nativo";c.OpenX="openx";c.OpenXServer="opnx_ss";c.Pubmatic="pubmatic";c.PubmaticServer="pubm_ss";c.ResetDigital="resetdigital";c.Roundel="roundel";c.Rtbhouse="rtbhouse";c.Rubicon="rubicon";c.RubiconServer="rubi_ss";c.Sharethrough="sharethrough";c.Spotx="spotx";c.Teads="teads";c.Triplelift="triplelift";c.TripleliftServer="tripl_ss";c.TTD="ttd";c.Undertone="undertone";c.UndertoneServer="under_ss";c.Unruly="unruly";c.YahooSSP="yahoossp";c.Verizon="verizon";c.Yieldmo="yieldmo"})(z||
(z={}));var D;(function(c){c.Prebid="prebid";c.GAM="gam";c.Amazon="amazon";c.WebVitals="webvitals";c.Marmalade="marmalade";c.Floors="floors";c.CMP="cmp"})(D||(D={}));var V;(function(c){c.fpvNonLazy="fpvNonLazy";c.lazy="lazy";c.refresh="refresh";c.session="session";c.crossDomain="crossdomain";c.highSequence="highsequence"})(V||(V={}));var W;(function(c){c.prebidLoad="prebidLoad";c.amazonLoad="amazonLoad";c.gptLoad="gptLoad"})(W||(W={}));var J;(function(c){c.Desktop="desktop";c.Mobile="mobile"})(J||
(J={}));var F;(function(c){c.Video_Collapse_Autoplay_SoundOff="Video_Collapse_Autoplay_SoundOff";c.Video_Individual_Autoplay_SOff="Video_Individual_Autoplay_SOff";c.Video_Coll_SOff_Smartphone="Video_Coll_SOff_Smartphone";c.Video_In_Post_ClicktoPlay_SoundOn="Video_In-Post_ClicktoPlay_SoundOn"})(F||(F={}));var X;(X||(X={})).None="none";var Y;(function(c){c.WEIGHTEDCHOICE="weightedChoice";c.BERNOULLITRIAL="bernoulliTrial"})(Y||(Y={}));var Z;(function(c){c.INTEGER="integer";c.FLOAT="float";c.BOOLEAN=
"boolean";c.STRING="string"})(Z||(Z={}));var aa;(function(c){c.DESKTOP="desktop";c.MOBILE="mobile";c.ALL="all"})(aa||(aa={}));var E;(function(c){c.AdDensity="addensity";c.AdLayout="adlayout";c.FooterCloseButton="footerclose";c.Interstitial="interstitial";c.RemoveVideoTitleWrapper="removevideotitlewrapper";c.StickyOutstream="stickyoutstream";c.StickyOutstreamOnStickyPlayer="sospp";c.VideoAdvancePlaylistRelatedPlayer="videoadvanceplaylistrp";c.MobileStickyPlayerPosition="mspp"})(E||(E={}));var sa=function(c,
a){var b=c.adDensityEnabled;c=c.adDensityLayout.pageOverrides.find(function(d){return!!document.querySelector(d.pageSelector)&&(d[a].onePerViewport||"number"===typeof d[a].adDensity)});return b?!c:!0};z=function(){function c(){this._timeOrigin=0}c.prototype.resetTimeOrigin=function(){this._timeOrigin=window.performance.now()};c.prototype.now=function(){try{return Math.round(window.performance.now()-this._timeOrigin)}catch(a){return 0}};return c}();window.adthrive.windowPerformance=window.adthrive.windowPerformance||
new z;z=window.adthrive.windowPerformance;var S=z.now.bind(z),ba=function(c){try{return{valid:!0,elements:document.querySelectorAll(c)}}catch(a){return x({valid:!1},a)}},ca=function(c){return""===c?{valid:!0}:ba(c)},ta=function(c){var a=c.reduce(function(b,d){return d.weight?d.weight+b:b},0);return 0<c.length&&c.every(function(b){var d=b.value;b=b.weight;return!(void 0===d||null===d||"number"===typeof d&&isNaN(d)||!b)})&&100===a},ua=["siteId","siteName","adOptions","breakpoints","adUnits"],da=function(){function c(){this._clsGlobalData=
window.adthriveCLS}Object.defineProperty(c.prototype,"enabled",{get:function(){var a;if(a=!!this._clsGlobalData&&!!this._clsGlobalData.siteAds)a:{a=this._clsGlobalData.siteAds;var b=void 0;void 0===b&&(b=ua);if(a){for(var d=0;d<b.length;d++)if(!a[b[d]]){a=!1;break a}a=!0}else a=!1}return a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"error",{get:function(){return!(!this._clsGlobalData||!this._clsGlobalData.error)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,
"siteAds",{get:function(){return this._clsGlobalData.siteAds},set:function(a){this._clsGlobalData.siteAds=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"disableAds",{get:function(){return this._clsGlobalData.disableAds},set:function(a){this._clsGlobalData.disableAds=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"enabledLocations",{get:function(){return this._clsGlobalData.enabledLocations},set:function(a){this._clsGlobalData.enabledLocations=a},enumerable:!1,
configurable:!0});Object.defineProperty(c.prototype,"injectedFromPlugin",{get:function(){return this._clsGlobalData.injectedFromPlugin},set:function(a){this._clsGlobalData.injectedFromPlugin=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"injectedFromSiteAds",{get:function(){return this._clsGlobalData.injectedFromSiteAds},set:function(a){this._clsGlobalData.injectedFromSiteAds=a},enumerable:!1,configurable:!0});c.prototype.overwriteInjectedSlots=function(a){this._clsGlobalData.injectedSlots=
a};c.prototype.setInjectedSlots=function(a){this._clsGlobalData.injectedSlots=this._clsGlobalData.injectedSlots||[];this._clsGlobalData.injectedSlots.push(a)};Object.defineProperty(c.prototype,"injectedSlots",{get:function(){return this._clsGlobalData.injectedSlots},enumerable:!1,configurable:!0});c.prototype.setInjectedVideoSlots=function(a){this._clsGlobalData.injectedVideoSlots=this._clsGlobalData.injectedVideoSlots||[];this._clsGlobalData.injectedVideoSlots.push(a)};Object.defineProperty(c.prototype,
"injectedVideoSlots",{get:function(){return this._clsGlobalData.injectedVideoSlots},enumerable:!1,configurable:!0});c.prototype.setInjectedScripts=function(a){this._clsGlobalData.injectedScripts=this._clsGlobalData.injectedScripts||[];this._clsGlobalData.injectedScripts.push(a)};Object.defineProperty(c.prototype,"getInjectedScripts",{get:function(){return this._clsGlobalData.injectedScripts},enumerable:!1,configurable:!0});c.prototype.setExperiment=function(a,b,d){void 0===d&&(d=!1);this._clsGlobalData.experiments=
this._clsGlobalData.experiments||{};this._clsGlobalData.siteExperiments=this._clsGlobalData.siteExperiments||{};(d?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments)[a]=b};c.prototype.getExperiment=function(a,b){void 0===b&&(b=!1);return(b=b?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments)&&b[a]};c.prototype.setWeightedChoiceExperiment=function(a,b,d){void 0===d&&(d=!1);this._clsGlobalData.experimentsWeightedChoice=this._clsGlobalData.experimentsWeightedChoice||
{};this._clsGlobalData.siteExperimentsWeightedChoice=this._clsGlobalData.siteExperimentsWeightedChoice||{};(d?this._clsGlobalData.siteExperimentsWeightedChoice:this._clsGlobalData.experimentsWeightedChoice)[a]=b};c.prototype.getWeightedChoiceExperiment=function(a,b){var d,e;void 0===b&&(b=!1);return(b=b?null===(d=this._clsGlobalData)||void 0===d?void 0:d.siteExperimentsWeightedChoice:null===(e=this._clsGlobalData)||void 0===e?void 0:e.experimentsWeightedChoice)&&b[a]};Object.defineProperty(c.prototype,
"branch",{get:function(){return this._clsGlobalData.branch},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"bucket",{get:function(){return this._clsGlobalData.bucket},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"videoDisabledFromPlugin",{get:function(){return this._clsGlobalData.videoDisabledFromPlugin},set:function(a){this._clsGlobalData.videoDisabledFromPlugin=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"targetDensityLog",{get:function(){return this._clsGlobalData.targetDensityLog},
set:function(a){this._clsGlobalData.targetDensityLog=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"removeVideoTitleWrapper",{get:function(){return this._clsGlobalData.siteAds.adOptions.removeVideoTitleWrapper},enumerable:!1,configurable:!0});return c}(),va=function(){function c(){}c.getScrollTop=function(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)};c.shufflePlaylist=function(a){for(var b=a.length,d,e;0!==b;)e=Math.floor(Math.random()*
a.length),--b,d=a[b],a[b]=a[e],a[e]=d;return a};c.isMobileLandscape=function(){return window.matchMedia("(orientation: landscape) and (max-height: 480px)").matches};c.playerViewable=function(a){a=a.getBoundingClientRect();return this.isMobileLandscape()?window.innerHeight>a.top+a.height/2&&0<a.top+a.height/2:window.innerHeight>a.top+a.height/2};c.playerVisible=function(a){a=a.getBoundingClientRect();return window.innerHeight>a.top};c.createQueryString=function(a){return Object.keys(a).map(function(b){return"".concat(b,
"=").concat(a[b])}).join("&")};c.createEncodedQueryString=function(a){return Object.keys(a).map(function(b){return"".concat(b,"=").concat(encodeURIComponent(a[b]))}).join("&")};c.setMobileLocation=function(a){a=a||"bottom-right";"top-left"===a?a="adthrive-collapse-top-left":"top-right"===a?a="adthrive-collapse-top-right":"bottom-left"===a?a="adthrive-collapse-bottom-left":"bottom-right"===a?a="adthrive-collapse-bottom-right":"top-center"===a&&(a=L()?"adthrive-collapse-top-center":"adthrive-collapse-bottom-right");
return a};c.addMaxResolutionQueryParam=function(a){var b=L()?"320":"1280";b="max_resolution=".concat(b);var d=p(String(a).split("?"),2);a=d[0];b=(d=d[1])?d+"&".concat(b):b;return"".concat(a,"?").concat(b)};return c}(),wa=function(){return function(c){this._clsOptions=c;this.removeVideoTitleWrapper=u(this._clsOptions.siteAds.adOptions.removeVideoTitleWrapper,!1);c=this._clsOptions.siteAds.videoPlayers;this.footerSelector=u(c&&c.footerSelector,"");this.players=u(c&&c.players.map(function(a){a.mobileLocation=
va.setMobileLocation(a.mobileLocation);return a}),[]);this.contextualSettings=c&&c.contextual}}(),xa=function(){return function(c){this.contextualPlayerAdded=this.playlistPlayerAdded=this.mobileStickyPlayerOnPage=!1;this.footerSelector="";this.removeVideoTitleWrapper=!1;this.videoAdOptions=new wa(c);this.players=this.videoAdOptions.players;this.contextualSettings=this.videoAdOptions.contextualSettings;this.removeVideoTitleWrapper=this.videoAdOptions.removeVideoTitleWrapper;this.footerSelector=this.videoAdOptions.footerSelector}}();
D=function(){return function(){}}();var M=function(c){function a(b){var d=c.call(this)||this;d._probability=b;return d}y(a,c);a.prototype.get=function(){if(0>this._probability||1<this._probability)throw Error("Invalid probability: ".concat(this._probability));return Math.random()<this._probability};return a}(D);z=function(){function c(){this._clsOptions=new da;this.shouldUseCoreExperimentsConfig=!1}c.prototype.setExperimentKey=function(a){void 0===a&&(a=!1);this._clsOptions.setExperiment(this.key,
this.result,a)};return c}();var ya=function(c){function a(){var b=c.call(this)||this;b._result=!1;b._choices=[{choice:!0},{choice:!1}];b.key="smhd100";b._result=b.run();b.setExperimentKey();return b}y(a,c);Object.defineProperty(a.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0});a.prototype.run=function(){return(new M(.1)).get()};return a}(z),ea=function(c,a,b,d,e,f){c=Math.round(f-e);a=[];e=[];a.push("(",b.map(function(){return"%o"}).join(", "),")");e.push.apply(e,
w([],p(b),!1));void 0!==d&&(a.push(" => %o"),e.push(d));a.push(" %c(".concat(c,"ms)"));e.push("color: #999;")},fa=function(c,a,b){var d=void 0!==b.get?b.get:b.value;return function(){for(var e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];try{var g=S(),h=d.apply(this,e);if(h instanceof Promise)return h.then(function(k){var m=S();ea(c,a,e,k,g,m);return Promise.resolve(k)}).catch(function(k){k.logged||(n.error(c,a,k),k.logged=!0);throw k;});var l=S();ea(c,a,e,h,g,l);return h}catch(k){throw k.logged||
(n.error(c,a,k),k.logged=!0),k;}}},T=function(c,a){void 0===a&&(a=!1);return function(b){var d,e=Object.getOwnPropertyNames(b.prototype).filter(function(r){return a||0!==r.indexOf("_")}).map(function(r){return[r,Object.getOwnPropertyDescriptor(b.prototype,r)]});try{for(var f=K(e),g=f.next();!g.done;g=f.next()){var h=p(g.value,2),l=h[0],k=h[1];void 0!==k&&"function"===typeof k.value?b.prototype[l]=fa(c,l,k):void 0!==k&&void 0!==k.get&&"function"===typeof k.get&&Object.defineProperty(b.prototype,l,
x(x({},k),{get:fa(c,l,k)}))}}catch(r){var m={error:r}}finally{try{g&&!g.done&&(d=f.return)&&d.call(f)}finally{if(m)throw m.error;}}}},za=function(c){function a(){var b=c.call(this)||this;b._result=!1;b.key="conmax99";b._choices=[{choice:!0},{choice:!1}];b.weight=.02;b._result=b.run();b.setExperimentKey();return b}y(a,c);Object.defineProperty(a.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0});a.prototype.run=function(){return(new M(this.weight)).get()};return a=
I([T("MaxContentExperiment"),C("design:paramtypes",[])],a)}(z),Aa=function(c){function a(b){var d=c.call(this)||this;d._result=!1;d.key="parallax";d._choices=[{choice:!0},{choice:!1}];d.weight=.5;L()&&b.largeFormatsMobile&&(d._result=d.run(),d.setExperimentKey());return d}y(a,c);Object.defineProperty(a.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0});a.prototype.run=function(){return(new M(this.weight)).get()};return a=I([T("ParallaxAdsExperiment"),C("design:paramtypes",
[Object])],a)}(z),Ba=[[728,90],[300,250],[300,600],[320,50],[970,250],[160,600],[300,1050],[336,280],[970,90],[300,50],[320,100],[468,60],[250,250],[120,240],[1,1],[300,300],[552,334],[300,420],[728,250],[320,300],[300,390]],Ca=[[300,600]],Da=new Map([["Footer",1],["Header",2],["Sidebar",3],["Content",4],["Recipe",5],["Sidebar_sticky",6],["Below Post",7]]),Ea=function(c){return Ba.filter(function(a){a=p(a,2);var b=a[0],d=a[1];return c.some(function(e){e=p(e,2);var f=e[1];return b===e[0]&&d===f})})},
Fa=function(c,a,b,d){a=p(a,2);var e=a[0],f=a[1];a=c.location;var g=c.sequence;b="Footer"===a&&"phone"===b&&320===e&&100===f;e="Header"===a&&100<f&&d.result;var h=c.adSizes.some(function(l){return 300>=p(l,2)[1]});d="Sidebar"===a&&g&&9!==g&&h&&300<f&&d.result;c="Sidebar"===a&&g&&5>=g&&c.sticky;return!(b||e||d)||c},Ga=function(c){var a,b;if(!c.adTypes)return!1;var d=new Aa(c.adTypes);return(null===(b=null===(a=c.adOptions.stickyContainerConfig)||void 0===a?void 0:a.content)||void 0===b?0:b.enabled)?
!1:d.result},Ha=function(c,a){var b=a.adUnits,d=Ga(a),e=new ya,f=new za;return b.filter(function(g){return void 0!==g.dynamic&&g.dynamic.enabled}).map(function(g){var h=g.location.replace(/\s+/g,"_"),l="Sidebar"===h?0:2;return{auctionPriority:Da.get(h)||8,location:h,sequence:u(g.sequence,1),sizes:Ea(g.adSizes).filter(function(k){return Fa(g,k,c,e)}).concat(d&&"Content"===g.location?Ca:[]),devices:g.devices,pageSelector:u(g.dynamic.pageSelector,"").trim(),elementSelector:u(g.dynamic.elementSelector,
"").trim(),position:u(g.dynamic.position,"beforebegin"),max:f.result&&"Content"===g.location?99:Math.floor(u(g.dynamic.max,0)),spacing:u(g.dynamic.spacing,0),skip:Math.floor(u(g.dynamic.skip,0)),every:Math.max(Math.floor(u(g.dynamic.every,1)),1),classNames:g.dynamic.classNames||[],sticky:"Footer"===g.location?!0:g.sticky,stickyOverlapSelector:u(g.stickyOverlapSelector,"").trim(),autosize:g.autosize,special:u(g.targeting,[]).filter(function(k){return"special"===k.key}).reduce(function(k,m){return k.concat.apply(k,
w([],p(m.value),!1))},[]),lazy:u(g.dynamic.lazy,!1),lazyMax:u(g.dynamic.lazyMax,l),lazyMaxDefaulted:0===g.dynamic.lazyMax?!1:!g.dynamic.lazyMax}})},ha=function(c,a){var b=la(a),d=c.sticky&&"Sidebar"===c.location;return c.sizes.filter(function(e){var f=d?e[1]<=window.innerHeight-100:!0;return(c.autosize?e[0]<=b||320>=e[0]:!0)&&f})},Ia=function(){return function(c){this.clsOptions=c;this.enabledLocations=["Below_Post","Content","Recipe","Sidebar"]}}(),Ja=function(c){var a=document.body;c="adthrive-device-".concat(c);
if(!a.classList.contains(c))try{a.classList.add(c)}catch(b){n.error("BodyDeviceClassComponent","init",{message:b.message}),a="classList"in document.createElement("_"),n.error("BodyDeviceClassComponent","init.support",{support:a})}},Ka=function(c){c='\n  .adthrive-device-phone .adthrive-sticky-content {\n    height: 450px !important;\n    margin-bottom: 100px !important;\n  }\n  .adthrive-content.adthrive-sticky {\n    position: -webkit-sticky;\n    position: sticky !important;\n    top: 42px !important;\n    margin-top: 42px !important;\n  }\n  .adthrive-content.adthrive-sticky:after {\n    content: "\u2014 Advertisement. Scroll down to continue. \u2014";\n    font-size: 10pt;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    display:block;\n    color: #888;\n  }\n  .adthrive-sticky-container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    min-height:'.concat(c?
c:400,"px !important;\n    margin: 10px 0 10px 0;\n    background-color: #FAFAFA;\n    padding-bottom:0px;\n  }\n  ");var a=void 0;void 0===a&&(a={});a=a.insertAt;if(c&&"undefined"!==typeof document){var b=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css";"top"===a?b.firstChild?b.insertBefore(d,b.firstChild):b.appendChild(d):b.appendChild(d);d.styleSheet?d.styleSheet.cssText=c:d.appendChild(document.createTextNode(c))}},La=function(c){return c.some(function(a){return null!==
document.querySelector(a)})},U=function(c){function a(b,d){void 0===b&&(b=[]);var e=c.call(this)||this;e._choices=b;e._default=d;return e}y(a,c);a.fromArray=function(b,d){return new a(b.map(function(e){e=p(e,2);return{choice:e[0],weight:e[1]}}),d)};a.prototype.addChoice=function(b,d){this._choices.push({choice:b,weight:d})};a.prototype.get=function(){var b,d=100*Math.random(),e=0;try{for(var f=K(this._choices),g=f.next();!g.done;g=f.next()){var h=g.value,l=h.choice;e+=h.weight;if(e>=d)return l}}catch(m){var k=
{error:m}}finally{try{g&&!g.done&&(b=f.return)&&b.call(f)}finally{if(k)throw k.error;}}return this._default};Object.defineProperty(a.prototype,"totalWeight",{get:function(){return this._choices.reduce(function(b,d){return b+d.weight},0)},enumerable:!1,configurable:!0});return a}(D),Ma=function(c){for(var a=5381,b=c.length;b;)a=33*a^c.charCodeAt(--b);return a>>>0},N=new (function(){function c(){var a=this;this.name="Session";this.disable=!1;this.removeSessionValue=function(b){window.localStorage.removeItem("adthrive_".concat(b.toLowerCase()))};
this.getSessionValue=function(b,d,e){void 0===e&&(e=!1);if(a.disable)return null;try{var f=window.localStorage.getItem("adthrive_".concat(b.toLowerCase()));if(f){var g=JSON.parse(f),h=void 0!==d&&Date.now()-g.created>=d;if(g&&!h)return e&&a.setSessionValue(b,g.value),g.value}}catch(l){}return null};this.setSessionValue=function(b,d){try{var e={value:d,created:Date.now()};window.localStorage.setItem("adthrive_".concat(b.toLowerCase()),JSON.stringify(e))}catch(f){}};this.isValidABGroupSessionValue=
function(b){return void 0!==b&&null!==b&&!("number"===typeof b&&isNaN(b))};this.getOrSetSessionValue=function(b,d,e,f,g){void 0===f&&(f=!0);e=a.getSessionValue(b,e,f);if(null!==e)return e;d=d();a.setSessionValue(b,d);g&&g(d);return d};this.getOrSetABGroupSessionValue=function(b,d,e,f,g){var h;void 0===f&&(f=!0);e=a.getSessionValue("abgroup",e,f);if(null!==e&&(f=e[b],a.isValidABGroupSessionValue(f)))return f;d=d();b=x(x({},e),(h={},h[b]=d,h));a.setSessionValue("abgroup",b);g&&g();return d}}c.prototype.init=
function(){};return c}()),ia=function(){return function(c,a,b){var d=b.value;d&&(b.value=function(){for(var e=this,f,g=[],h=0;h<arguments.length;h++)g[h]=arguments[h];h=Array.isArray(this._choices)?Ma(JSON.stringify(this._choices)).toString(16):null;var l=this.key?this.key.toLowerCase():"";h=h?"".concat(l,"_").concat(h):l;h=this.sessionStoragePrefix?"".concat(this.sessionStoragePrefix,"-").concat(h):h;!1===(null===(f=N.getSessionValue("branch"))||void 0===f?void 0:f.enabled)&&N.removeSessionValue(h);
return N.getOrSetABGroupSessionValue(h,function(){return d.apply(e,g)},864E5)})}};D=function(c){function a(){var b=null!==c&&c.apply(this,arguments)||this;b._resultValidator=function(){return!0};return b}y(a,c);a.prototype._isValidResult=function(b){var d=this;return c.prototype._isValidResult.call(this,b,function(){return d._resultValidator(b)||"control"===b})};a.prototype.run=function(){if(!this.enabled)return n.error("CLSWeightedChoiceSiteExperiment","run","() => %o","No experiment config found. Defaulting to control."),
"control";if(!this._mappedChoices||0===this._mappedChoices.length)return n.error("CLSWeightedChoiceSiteExperiment","run","() => %o","No experiment variants found. Defaulting to control."),"control";var b=(new U(this._mappedChoices)).get();if(this._isValidResult(b))return b;n.error("CLSWeightedChoiceSiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to control.");return"control"};return a}(function(){function c(){}Object.defineProperty(c.prototype,"enabled",{get:function(){return void 0!==
this.experimentConfig},enumerable:!1,configurable:!0});c.prototype._isValidResult=function(a,b){void 0===b&&(b=function(){return!0});return b()&&N.isValidABGroupSessionValue(a)};return c}());var ja=function(){function c(a){var b=this,d,e;this.siteExperiments=[];this._clsOptions=a;this._device=L()?"mobile":"desktop";this.siteExperiments=null!==(e=null===(d=this._clsOptions.siteAds.siteExperiments)||void 0===d?void 0:d.filter(function(f){var g=f.key;var h=b._device;if(f){var l=!!f.enabled,k=null==f.dateStart||
Date.now()>=f.dateStart,m=null==f.dateEnd||Date.now()<=f.dateEnd,r=null===f.selector||""!==f.selector&&!!document.querySelector(f.selector),t="mobile"===f.platform&&"mobile"===h;h="desktop"===f.platform&&"desktop"===h;t=null===f.platform||"all"===f.platform||t||h;(h="bernoulliTrial"===f.experimentType?1===f.variants.length:ta(f.variants))||n.error("ValidateSiteExperiment","util","experiment presented invalid choices for key:",f.key,f.variants);f=l&&k&&m&&r&&t&&h}else f=!1;a:switch(l=b._clsOptions.siteAds,
g){case E.AdDensity:var q=sa(l,b._device);break a;case E.StickyOutstream:var B,A;q=(g=null===(A=null===(B=null===(q=l.videoPlayers)||void 0===q?void 0:q.partners)||void 0===B?void 0:B.stickyOutstream)||void 0===A?void 0:A.blockedPageSelectors)?!document.querySelector(g):!0;break a;case E.Interstitial:q=(q=l.adOptions.interstitialBlockedPageSelectors||l.adOptions.mobileInterstitialBlockedPageSelectors)?!document.querySelector(q):!0;break a;default:q=!0}return f&&q}))&&void 0!==e?e:[]}c.prototype.getSiteExperimentByKey=
function(a){return this.siteExperiments.filter(function(b){return b.key.toLowerCase()===a.toLowerCase()})[0]};return c}(),Na=function(c){function a(b){var d=c.call(this)||this;d._choices=[];d._mappedChoices=[];d._result="";d._resultValidator=function(e){return"string"===typeof e};d.key=E.AdLayout;d._clsSiteExperiments=new ja(b);d.experimentConfig=d._clsSiteExperiments.getSiteExperimentByKey(d.key);d.enabled&&d.experimentConfig&&(d._choices=d.experimentConfig.variants,d._mappedChoices=d._mapChoices(),
d._result=d.run(),b.setWeightedChoiceExperiment(d.key,d._result,!0));return d}y(a,c);Object.defineProperty(a.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0});a.prototype.run=function(){if(!this.enabled)return n.error("CLSAdLayoutSiteExperiment","run","() => %o","No experiment config found. Defaulting to empty class name."),"";var b=(new U(this._mappedChoices)).get();if(this._isValidResult(b))return b;n.error("CLSAdLayoutSiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to empty class name.");
return""};a.prototype._mapChoices=function(){return this._choices.map(function(b){return{weight:b.weight,choice:b.value}})};I([ia(),C("design:type",Function),C("design:paramtypes",[]),C("design:returntype",void 0)],a.prototype,"run",null);return a}(D),Oa=function(c){function a(b){var d=c.call(this)||this;d._choices=[];d._mappedChoices=[];d._result="control";d._resultValidator=function(e){return"number"===typeof e};d.key=E.AdDensity;d._clsSiteExperiments=new ja(b);d.experimentConfig=d._clsSiteExperiments.getSiteExperimentByKey(d.key);
d.enabled&&d.experimentConfig&&(d._choices=d.experimentConfig.variants,d._mappedChoices=d._mapChoices(),d._result=d.run(),b.setWeightedChoiceExperiment(d.key,d._result,!0));return d}y(a,c);Object.defineProperty(a.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0});a.prototype.run=function(){if(!this.enabled)return n.error("CLSTargetAdDensitySiteExperiment","run","() => %o","No experiment config found. Defaulting to control."),"control";var b=(new U(this._mappedChoices)).get();
if(this._isValidResult(b))return b;n.error("CLSTargetAdDensitySiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to control.");return"control"};a.prototype._mapChoices=function(){return this._choices.map(function(b){var d=b.value;return{weight:b.weight,choice:"number"===typeof d?(d||0)/100:"control"}})};I([ia(),C("design:type",Function),C("design:paramtypes",[]),C("design:returntype",void 0)],a.prototype,"run",null);return a}(D),Pa=function(c){function a(){var b=
c.call(this)||this;b._result=!1;b.key="scae";b._choices=[{choice:!0},{choice:!1}];b.weight=.99;b._result=b.run();b.setExperimentKey();return b}y(a,c);Object.defineProperty(a.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0});a.prototype.run=function(){return(new M(this.weight)).get()};return a=I([T("StickyContainerAdsExperiment"),C("design:paramtypes",[])],a)}(z),Sa=function(){function c(a,b){this._clsOptions=a;this._adInjectionMap=b;this._mainContentHeight=this._recipeCount=
0;this._mainContentDiv=null;this._totalAvailableElements=[];this._minDivHeight=250;this._densityDevice=J.Desktop;this._pubLog={onePerViewport:!1,targetDensity:0,targetDensityUnits:0,combinedMax:0};this._densityMax=.99;this._smallerIncrementAttempts=0;this._absoluteMinimumSpacingByDevice=250;this._usedAbsoluteMinimum=!1;this._infPageEndOffset=0;this.locationMaxLazySequence=new Map([["Recipe",5]]);this.locationToMinHeight={Below_Post:"250px",Content:"250px",Recipe:"250px",Sidebar:"250px"};b=this._clsOptions.siteAds.breakpoints;
var d=b.tablet;var e=window.innerWidth;b=e>=b.desktop?"desktop":e>=d?"tablet":"phone";this._device=b;this._config=new Ia(a);this._clsOptions.enabledLocations=this._config.enabledLocations;this._clsTargetAdDensitySiteExperiment=this._clsOptions.siteAds.siteExperiments?new Oa(this._clsOptions):null;this._stickyContainerAdsExperiment=new Pa}c.prototype.start=function(){var a=this,b,d,e,f;try{Ja(this._device);var g=new Na(this._clsOptions);if(g.enabled){var h=g.result.substring(1);document.body.classList.add(h)}var l=
Ha(this._device,this._clsOptions.siteAds).filter(function(m){return a._locationEnabled(m)}).filter(function(m){return m.devices.includes(a._device)}).filter(function(m){return 0===m.pageSelector.length||null!==document.querySelector(m.pageSelector)}),k=this.inject(l);(null===(d=null===(b=this._clsOptions.siteAds.adOptions.stickyContainerConfig)||void 0===b?void 0:b.content)||void 0===d?0:d.enabled)&&this._stickyContainerAdsExperiment.result&&!La(this._clsOptions.siteAds.adOptions.stickyContainerConfig.blockedSelectors||
[])&&Ka(null===(f=null===(e=this._clsOptions.siteAds.adOptions.stickyContainerConfig)||void 0===e?void 0:e.content)||void 0===f?void 0:f.minHeight);k.forEach(function(m){return a._clsOptions.setInjectedSlots(m)})}catch(m){n.error("ClsDynamicAdsInjector","start",m)}};c.prototype.inject=function(a,b){void 0===b&&(b=document);this._densityDevice="desktop"===this._device?J.Desktop:J.Mobile;this._overrideDefaultAdDensitySettingsWithSiteExperiment();var d=this._clsOptions.siteAds,e=u(d.adDensityEnabled,
!0),f=d.adDensityLayout&&e;d=a.filter(function(g){return f?"Content"!==g.location:g});a=a.filter(function(g){return f?"Content"===g.location:null});return w(w([],p(d.length?this._injectNonDensitySlots(d,b):[]),!1),p(a.length?this._injectDensitySlots(a,b):[]),!1)};c.prototype._injectNonDensitySlots=function(a,b){var d,e=this;void 0===b&&(b=document);var f=[],g=[];try{for(var h=K(a),l=h.next();!l.done;l=h.next()){var k=l.value,m=0,r=0,t=0;0<k.spacing&&(r=m=window.innerHeight*k.spacing);var q=this._repeatDynamicAds(k),
B=this.getElements(k.elementSelector,b);a=function(v){if(t+1>q.length)return"break";var G=B[v];if(0<m){v=ma(G).bottom;if(v<=r)return"continue";r=v+m}v=q[t];var ka="".concat(v.location,"_").concat(v.sequence);f.some(function(Qa){return Qa.name===ka})&&(t+=1);var O=A.getDynamicElementId(v),P="adthrive-".concat(k.location.replace("_","-").toLowerCase()),Ra="".concat(P,"-").concat(k.sequence);P=w([P,Ra],p(k.classNames),!1);if(G=A.addAd(G,O,k.position,P))O=ha(v,G),O.length&&(f.push({clsDynamicAd:k,dynamicAd:v,
element:G,sizes:O,name:ka,infinite:b!==document}),g.push({location:v.location,element:G}),"Recipe"===k.location&&++A._recipeCount,t+=1)};for(var A=this,H=k.skip;H<B.length&&"break"!==a(H);H+=k.every);}}catch(v){var Q={error:v}}finally{try{l&&!l.done&&(d=h.return)&&d.call(h)}finally{if(Q)throw Q.error;}}g.forEach(function(v){v.element.style.minHeight=e.locationToMinHeight[v.location]});return f};c.prototype._injectDensitySlots=function(a,b){void 0===b&&(b=document);try{this._calculateMainContentHeightAndAllElements(a,
b)}catch(h){return[]}var d=this._getDensitySettings(a,b);a=d.onePerViewport;var e=d.targetAll,f=d.targetDensityUnits,g=d.combinedMax;d=d.numberOfUnits;this._absoluteMinimumSpacingByDevice=a?window.innerHeight:this._absoluteMinimumSpacingByDevice;if(!d)return[];this._adInjectionMap.filterUsed();this._findElementsForAds(d,a,e,g,f,b);return this._insertAds()};c.prototype._overrideDefaultAdDensitySettingsWithSiteExperiment=function(){var a;if(null===(a=this._clsTargetAdDensitySiteExperiment)||void 0===
a?0:a.enabled)a=this._clsTargetAdDensitySiteExperiment.result,"number"===typeof a&&(this._clsOptions.siteAds.adDensityEnabled=!0,this._clsOptions.siteAds.adDensityLayout[this._densityDevice].adDensity=a)};c.prototype._getDensitySettings=function(a,b){void 0===b&&(b=document);var d=this._clsOptions.siteAds.adDensityLayout,e=this._determineOverrides(d.pageOverrides);e=e.length?e[0]:d[this._densityDevice];d=e.adDensity;e=e.onePerViewport;var f=this._shouldTargetAllEligible(d),g=this._getTargetDensityUnits(d,
f);a=this._getCombinedMax(a,b);b=Math.min.apply(Math,w([],p(w([this._totalAvailableElements.length,g],p(0<a?[a]:[]),!1)),!1));this._pubLog={onePerViewport:e,targetDensity:d,targetDensityUnits:g,combinedMax:a};return{onePerViewport:e,targetAll:f,targetDensityUnits:g,combinedMax:a,numberOfUnits:b}};c.prototype._determineOverrides=function(a){var b=this;return a.filter(function(d){var e=ca(d.pageSelector);return""===d.pageSelector||e.elements&&e.elements.length}).map(function(d){return d[b._densityDevice]})};
c.prototype._shouldTargetAllEligible=function(a){return a===this._densityMax};c.prototype._getTargetDensityUnits=function(a,b){return b?this._totalAvailableElements.length:Math.floor(a*this._mainContentHeight/(1-a)/this._minDivHeight)-this._recipeCount};c.prototype._getCombinedMax=function(a,b){void 0===b&&(b=document);return u(a.filter(function(d){try{var e=b.querySelector(d.elementSelector)}catch(f){}return e}).map(function(d){return Number(d.max)+Number(d.lazyMaxDefaulted?0:d.lazyMax)}).sort(function(d,
e){return e-d})[0],0)};c.prototype._elementLargerThanMainContent=function(a){return a.offsetHeight>=this._mainContentHeight&&1<this._totalAvailableElements.length};c.prototype._elementDisplayNone=function(a){var b=window.getComputedStyle(a,null).display;return b&&"none"===b||"none"===a.style.display};c.prototype._isBelowMaxes=function(a,b){return this._adInjectionMap.map.length<a&&this._adInjectionMap.map.length<b};c.prototype._findElementsForAds=function(a,b,d,e,f,g){var h=this;void 0===g&&(g=document);
this._clsOptions.targetDensityLog={onePerViewport:b,combinedMax:e,targetDensityUnits:f,targetDensityPercentage:this._pubLog.targetDensity,mainContentHeight:this._mainContentHeight,recipeCount:this._recipeCount,numberOfEls:this._totalAvailableElements.length};var l=function(k){var m;try{for(var r=K(h._totalAvailableElements),t=r.next();!t.done;t=r.next()){var q=t.value,B=q.dynamicAd,A=q.element;h._logDensityInfo(A,B.elementSelector,k);if(!(!d&&h._elementLargerThanMainContent(A)||h._elementDisplayNone(A)))if(h._isBelowMaxes(e,
f))h._checkElementSpacing({dynamicAd:B,element:A,insertEvery:k,targetAll:d,target:g});else break}}catch(Q){var H={error:Q}}finally{try{t&&!t.done&&(m=r.return)&&m.call(r)}finally{if(H)throw H.error;}}!h._usedAbsoluteMinimum&&5>h._smallerIncrementAttempts&&(++h._smallerIncrementAttempts,l(h._getSmallerIncrement(k)))};a=this._getInsertEvery(a,b,f);l(a)};c.prototype._getSmallerIncrement=function(a){a*=.6;a<=this._absoluteMinimumSpacingByDevice&&(a=this._absoluteMinimumSpacingByDevice,this._usedAbsoluteMinimum=
!0);return a};c.prototype._insertAds=function(){var a=this,b=[];this._adInjectionMap.filterUsed();this._adInjectionMap.map.forEach(function(d,e){var f=d.el,g=d.dynamicAd;d=d.target;e=Number(g.sequence)+e;var h=g.max;h=g.lazy&&e>h;g.sequence=e;g.lazy=h;if(f=a._addContentAd(f,g,d))g.used=!0,b.push(f)});return b};c.prototype._getInsertEvery=function(a,b,d){this._moreAvailableElementsThanUnitsToInject(d,a)?(this._usedAbsoluteMinimum=!1,a=this._useWiderSpacing(d,a)):(this._usedAbsoluteMinimum=!0,a=this._useSmallestSpacing(b));
return b&&window.innerHeight>a?window.innerHeight:a};c.prototype._useWiderSpacing=function(a,b){return this._mainContentHeight/Math.min(a,b)};c.prototype._useSmallestSpacing=function(a){return a&&window.innerHeight>this._absoluteMinimumSpacingByDevice?window.innerHeight:this._absoluteMinimumSpacingByDevice};c.prototype._moreAvailableElementsThanUnitsToInject=function(a,b){return this._totalAvailableElements.length>a||this._totalAvailableElements.length>b};c.prototype._logDensityInfo=function(a,b,
d){a=this._pubLog;a.onePerViewport;a.targetDensity;a.combinedMax};c.prototype._checkElementSpacing=function(a){var b=a.dynamicAd,d=a.element,e=a.insertEvery,f=a.targetAll;a=a.target;a=void 0===a?document:a;(this._isFirstAdInjected()||this._hasProperSpacing(d,b,f,e))&&this._markSpotForContentAd(d,x({},b),a)};c.prototype._isFirstAdInjected=function(){return!this._adInjectionMap.map.length};c.prototype._markSpotForContentAd=function(a,b,d){void 0===d&&(d=document);this._adInjectionMap.add(a,this._getElementCoords(a,
"beforebegin"===b.position||"afterbegin"===b.position),b,d);this._adInjectionMap.sort()};c.prototype._hasProperSpacing=function(a,b,d,e){var f="beforebegin"===b.position||"afterbegin"===b.position;b="beforeend"===b.position||"afterbegin"===b.position;d=d||this._isElementFarEnoughFromOtherAdElements(a,e,f);f=b||this._isElementNotInRow(a,f);a=-1===a.id.indexOf("AdThrive_".concat("Below_Post"));return d&&f&&a};c.prototype._isElementFarEnoughFromOtherAdElements=function(a,b,d){a=this._getElementCoords(a,
d);var e=!1;for(d=0;d<this._adInjectionMap.map.length&&!(e=this._adInjectionMap.map[d+1]&&this._adInjectionMap.map[d+1].coords,e=a-b>this._adInjectionMap.map[d].coords&&(!e||a+b<e));d++);return e};c.prototype._isElementNotInRow=function(a,b){var d=a.previousElementSibling,e=a.nextElementSibling;return(b=b?!d&&e||d&&a.tagName!==d.tagName?e:d:e)&&0===a.getBoundingClientRect().height?!0:b?a.getBoundingClientRect().top!==b.getBoundingClientRect().top:!0};c.prototype._calculateMainContentHeightAndAllElements=
function(a,b){void 0===b&&(b=document);a=p(ra(a,this._adInjectionMap,b),2);b=a[1];this._mainContentDiv=a[0];this._totalAvailableElements=b;a=this._mainContentDiv;b=void 0;void 0===b&&(b="div #comments, section .comments");this._mainContentHeight=(b=a.querySelector(b))?a.offsetHeight-b.offsetHeight:a.offsetHeight};c.prototype._getElementCoords=function(a,b){void 0===b&&(b=!1);a=a.getBoundingClientRect();return(b?a.top:a.bottom)+window.scrollY};c.prototype._addContentAd=function(a,b,d){var e,f;void 0===
d&&(d=document);var g=null,h="adthrive-".concat(b.location.replace("_","-").toLowerCase()),l="".concat(h,"-").concat(b.sequence),k=(null===(f=null===(e=this._clsOptions.siteAds.adOptions.stickyContainerConfig)||void 0===e?void 0:e.content)||void 0===f?0:f.enabled)&&this._stickyContainerAdsExperiment.result?"adthrive-sticky-container":"";if(a=this.addAd(a,this.getDynamicElementId(b),b.position,w([k,h,l],p(b.classNames),!1)))e=ha(b,a),e.length&&(a.style.minHeight=this.locationToMinHeight[b.location],
g="".concat(b.location,"_").concat(b.sequence),g={clsDynamicAd:b,dynamicAd:b,element:a,sizes:e,name:g,infinite:d!==document});return g};c.prototype.getDynamicElementId=function(a){return"".concat("AdThrive","_").concat(a.location,"_").concat(a.sequence,"_").concat(this._device)};c.prototype.getElements=function(a,b){void 0===b&&(b=document);return b.querySelectorAll(a)};c.prototype.addAd=function(a,b,d,e){void 0===e&&(e=[]);document.getElementById(b)||(e='<div id="'.concat(b,'" class="adthrive-ad ').concat(e.join(" "),
'"></div>'),a.insertAdjacentHTML(d,e));return document.getElementById(b)};c.prototype._repeatDynamicAds=function(a){var b=[],d=a.lazy?u(this.locationMaxLazySequence.get(a.location),0):0,e=a.max,f=a.lazyMax;d=Math.max(e,0===d&&a.lazy?e+f:Math.min(Math.max(d-a.sequence+1,0),e+f));for(f=0;f<d;f++){var g=Number(a.sequence)+f,h=a.lazy&&f>=e;b.push(x(x({},a),{sequence:g,lazy:h}))}return b};c.prototype._locationEnabled=function(a){a=this._clsOptions.enabledLocations.includes(a.location);var b=this._clsOptions.disableAds&&
this._clsOptions.disableAds.all||document.body.classList.contains("adthrive-disable-all"),d=!document.body.classList.contains("adthrive-disable-content")&&!this._clsOptions.disableAds.reasons.has("content_plugin");return a&&!b&&d};return c}(),Ta=function(c){function a(b,d){var e=c.call(this,b,"ClsVideoInsertion")||this;e._videoConfig=b;e._clsOptions=d;e._IN_POST_SELECTOR=".adthrive-video-player";e._WRAPPER_BAR_HEIGHT=36;e._playersAddedFromPlugin=[];d.removeVideoTitleWrapper&&(e._WRAPPER_BAR_HEIGHT=
0);return e}y(a,c);a.prototype.init=function(){this._initializePlayers()};a.prototype._wrapJWPlayerWithCLS=function(b,d,e){void 0===e&&(e=0);return b.parentNode?(d=this._createGenericCLSWrapper(.5625*b.offsetWidth,d,e),b.parentNode.insertBefore(d,b),d.appendChild(b),d):null};a.prototype._createGenericCLSWrapper=function(b,d,e){var f=document.createElement("div");f.id="cls-video-container-".concat(d);f.className="adthrive";f.style.minHeight="".concat(b+e,"px");return f};a.prototype._getTitleHeight=
function(b){b.innerText="Title";b.style.visibility="hidden";document.body.appendChild(b);var d=window.getComputedStyle(b),e=parseInt(d.height,10),f=parseInt(d.marginTop,10);d=parseInt(d.marginBottom,10);document.body.removeChild(b);return Math.min(e+d+f,50)};a.prototype._initializePlayers=function(){var b=document.querySelectorAll(this._IN_POST_SELECTOR);b.length&&this._initializeRelatedPlayers(b);this._shouldRunAutoplayPlayers()&&this._determineAutoplayPlayers()};a.prototype._createStationaryRelatedPlayer=
function(b,d){var e="mobile"===this._device?[400,225]:[640,360],f=F.Video_In_Post_ClicktoPlay_SoundOn;d&&b.mediaId&&(d=this._wrapJWPlayerWithCLS(d,b.mediaId),this._playersAddedFromPlugin.push(b.mediaId),d&&this._clsOptions.setInjectedVideoSlots({playerId:b.playerId,playerName:f,playerSize:e,element:d,type:"stationaryRelated"}))};a.prototype._createStickyRelatedPlayer=function(b,d){var e="mobile"===this._device?[400,225]:[640,360],f=F.Video_Individual_Autoplay_SOff;this._stickyRelatedOnPage=!0;this._videoConfig.mobileStickyPlayerOnPage=
"mobile"===this._device;if(d&&b.position&&b.mediaId){var g=document.createElement("div");d.insertAdjacentElement(b.position,g);d=document.createElement("h3");d.style.margin="10px 0";d=this._getTitleHeight(d);d=this._wrapJWPlayerWithCLS(g,b.mediaId,this._WRAPPER_BAR_HEIGHT+d);this._playersAddedFromPlugin.push(b.mediaId);d&&this._clsOptions.setInjectedVideoSlots({playlistId:b.playlistId,playerId:b.playerId,playerSize:e,playerName:f,element:g,type:"stickyRelated"})}};a.prototype._createPlaylistPlayer=
function(b,d){var e=b.playlistId,f="mobile"===this._device?F.Video_Coll_SOff_Smartphone:F.Video_Collapse_Autoplay_SoundOff,g="mobile"===this._device?[400,225]:[640,360];this._videoConfig.mobileStickyPlayerOnPage=!0;var h=document.createElement("div");d.insertAdjacentElement(b.position,h);d=this._wrapJWPlayerWithCLS(h,e,this._WRAPPER_BAR_HEIGHT);this._playersAddedFromPlugin.push("playlist-".concat(e));d&&this._clsOptions.setInjectedVideoSlots({playlistId:b.playlistId,playerId:b.playerId,playerSize:g,
playerName:f,element:h,type:"stickyPlaylist"})};a.prototype._isVideoAllowedOnPage=function(){var b=this._clsOptions.disableAds;if(b&&b.video){var d="";b.reasons.has("video_tag")?d="video tag":b.reasons.has("video_plugin")?d="video plugin":b.reasons.has("video_page")&&(d="command queue");n.error(d?"ClsVideoInsertionMigrated":"ClsVideoInsertion","isVideoAllowedOnPage",Error("DBP: Disabled by publisher via ".concat(d||"other")));return!1}return this._clsOptions.videoDisabledFromPlugin?!1:!0};return a}(function(c){function a(b,
d){var e=c.call(this)||this;e._videoConfig=b;e._component=d;e._stickyRelatedOnPage=!1;e._contextualMediaIds=[];b=void 0;void 0===b&&(b=navigator.userAgent);b=/Windows NT|Macintosh/i.test(b);e._device=b?"desktop":"mobile";e._potentialPlayerMap=e.setPotentialPlayersMap();return e}y(a,c);a.prototype.setPotentialPlayersMap=function(){var b=this._videoConfig.players||[],d=this._filterPlayerMap();b=b.filter(function(e){return"stationaryRelated"===e.type&&e.enabled});d.stationaryRelated=b;return this._potentialPlayerMap=
d};a.prototype._filterPlayerMap=function(){var b=this,d=this._videoConfig.players,e={stickyRelated:[],stickyPlaylist:[],stationaryRelated:[]};return d&&d.length?d.filter(function(f){var g;return null===(g=f.devices)||void 0===g?void 0:g.includes(b._device)}).reduce(function(f,g){f[g.type]||(n.event(b._component,"constructor","Unknown Video Player Type detected",g.type),f[g.type]=[]);g.enabled&&f[g.type].push(g);return f},e):e};a.prototype._checkPlayerSelectorOnPage=function(b){var d=this;b=this._potentialPlayerMap[b].map(function(e){return{player:e,
playerElement:d._getPlacementElement(e)}});return b.length?b[0]:{player:null,playerElement:null}};a.prototype._getOverrideElement=function(b,d,e){b&&d?(e=document.createElement("div"),d.insertAdjacentElement(b.position,e)):(d=this._checkPlayerSelectorOnPage("stickyPlaylist"),b=d.player,d=d.playerElement,b&&d&&(e=document.createElement("div"),d.insertAdjacentElement(b.position,e)));return e};a.prototype._shouldOverrideElement=function(b){b=b.getAttribute("override-embed");return"true"===b||"false"===
b?"true"===b:this._videoConfig.contextualSettings?this._videoConfig.contextualSettings.overrideEmbedLocation:!1};a.prototype._getPlacementElement=function(b){var d=ca(b.pageSelector),e=ba(b.elementSelector);if(!d.valid)return n.error("VideoUtils","getPlacementElement",Error("".concat(b.pageSelector," is not a valid selector"))),null;if(b.pageSelector&&!d.elements.length)return n.event("VideoUtils","getPlacementElement",Error("PSNF: ".concat(b.pageSelector," does not exist on the page"))),null;if(!e.valid)return n.error("VideoUtils",
"getPlacementElement",Error("".concat(b.elementSelector," is not a valid selector"))),null;if(e.elements.length>b.skip)return e.elements[b.skip];n.event("VideoUtils","getPlacementElement",Error("ESNF: ".concat(b.elementSelector," does not exist on the page")));return null};a.prototype._getEmbeddedPlayerType=function(b){(b=b.getAttribute("data-player-type"))&&"default"!==b||(b=this._videoConfig.contextualSettings?this._videoConfig.contextualSettings.defaultPlayerType:"static");this._stickyRelatedOnPage&&
(b="static");return b};a.prototype._getUnusedMediaId=function(b){return(b=b.getAttribute("data-video-id"))&&!this._contextualMediaIds.includes(b)?(this._contextualMediaIds.push(b),b):!1};a.prototype._createRelatedPlayer=function(b,d,e){"collapse"===d?this._createCollapsePlayer(b,e):"static"===d&&this._createStaticPlayer(b,e)};a.prototype._createCollapsePlayer=function(b,d){var e=this._checkPlayerSelectorOnPage("stickyRelated"),f=e.player;e=e.playerElement;var g=f?f:this._potentialPlayerMap.stationaryRelated[0];
g&&g.playerId?(this._shouldOverrideElement(d)&&(d=this._getOverrideElement(f,e,d)),d=document.querySelector("#cls-video-container-".concat(b," > div"))||d,this._createStickyRelatedPlayer(x(x({},g),{mediaId:b}),d)):n.error(this._component,"_createCollapsePlayer","No video player found")};a.prototype._createStaticPlayer=function(b,d){this._potentialPlayerMap.stationaryRelated.length&&this._potentialPlayerMap.stationaryRelated[0].playerId?this._createStationaryRelatedPlayer(x(x({},this._potentialPlayerMap.stationaryRelated[0]),
{mediaId:b}),d):n.error(this._component,"_createStaticPlayer","No video player found")};a.prototype._shouldRunAutoplayPlayers=function(){return this._isVideoAllowedOnPage()&&(this._potentialPlayerMap.stickyRelated.length||this._potentialPlayerMap.stickyPlaylist.length)?!0:!1};a.prototype._determineAutoplayPlayers=function(){var b=this._component,d="VideoManagerComponent"===b,e=this._config;if(this._stickyRelatedOnPage)n.event(b,"stickyRelatedOnPage",d&&{device:e&&e.context.device,isDesktop:this._device}||
{});else{var f=this._checkPlayerSelectorOnPage("stickyPlaylist"),g=f.player;f=f.playerElement;g&&g.playerId&&g.playlistId&&f?this._createPlaylistPlayer(g,f):n.event(b,"noStickyPlaylist",d&&{vendor:"none",device:e&&e.context.device,isDesktop:this._device}||{})}};a.prototype._initializeRelatedPlayers=function(b){for(var d=0;d<b.length;d++){var e=b[d],f=this._getEmbeddedPlayerType(e),g=this._getUnusedMediaId(e);g&&this._createRelatedPlayer(g,f,e)}};return a}(function(){function c(){}Object.defineProperty(c.prototype,
"enabled",{get:function(){return!0},enumerable:!1,configurable:!0});return c}())),Ua=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}y(a,c);return a}(function(){function c(){this._map=[]}c.prototype.add=function(a,b,d,e){void 0===e&&(e=document);this._map.push({el:a,coords:b,dynamicAd:d,target:e})};Object.defineProperty(c.prototype,"map",{get:function(){return this._map},enumerable:!1,configurable:!0});c.prototype.sort=function(){this._map.sort(function(a,b){return a.coords-
b.coords})};c.prototype.filterUsed=function(){this._map=this._map.filter(function(a){return!a.dynamicAd.used})};c.prototype.reset=function(){this._map=[]};return c}());try{(function(){var c=new da;c&&c.enabled&&((new Sa(c,new Ua)).start(),(new Ta(new xa(c),c)).init())})()}catch(c){n.error("CLS","pluginsertion-iife",c),window.adthriveCLS&&(window.adthriveCLS.injectedFromPlugin=!1)}})()
</script><script data-no-optimize="1" data-cfasync="false">(function () {var clsElements = document.querySelectorAll("script[id^='cls-']"); window.adthriveCLS && clsElements && clsElements.length === 0 ? window.adthriveCLS.injectedFromPlugin = false : ""; })();</script><script type="rocketlazyloadscript">window.advanced_ads_check_adblocker=function(t){var n=[],e=null;function i(t){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,16)}).call(window,t)}return i((function(){var t=document.createElement("div");t.innerHTML="&nbsp;",t.setAttribute("class","ad_unit ad-unit text-ad text_ad pub_300x250"),t.setAttribute("style","width: 1px !important; height: 1px !important; position: absolute !important; left: 0px !important; top: 0px !important; overflow: hidden !important;"),document.body.appendChild(t),i((function(){var i=window.getComputedStyle&&window.getComputedStyle(t),o=i&&i.getPropertyValue("-moz-binding");e=i&&"none"===i.getPropertyValue("display")||"string"==typeof o&&-1!==o.indexOf("about:");for(var a=0,r=n.length;a<r;a++)n[a](e);n=[]}))})),function(t){null!==e?t(e):n.push(t)}}();</script>
<script type="rocketlazyloadscript" data-cfasync="false" data-rocket-type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript">
		/* MonsterInsights Scroll Tracking */
		if ( typeof(jQuery) !== 'undefined' ) {
		jQuery( document ).ready(function(){
		function monsterinsights_scroll_tracking_load() {
		if ( ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) || ( typeof(__gtagTracker) !== 'undefined' && __gtagTracker ) ) {
		(function(factory) {
		factory(jQuery);
		}(function($) {

		/* Scroll Depth */
		"use strict";
		var defaults = {
		percentage: true
		};

		var $window = $(window),
		cache = [],
		scrollEventBound = false,
		lastPixelDepth = 0;

		/*
		* Plugin
		*/

		$.scrollDepth = function(options) {

		var startTime = +new Date();

		options = $.extend({}, defaults, options);

		/*
		* Functions
		*/

		function sendEvent(action, label, scrollDistance, timing) {
		if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
		return;
		}
			var type        = 'event';
	var eventName   = action;
	var fieldsArray = {
	event_category : 'Scroll Depth',
	event_label    : label,
	value          : 1,
	non_interaction: true,
	send_to: 'UA-44039733-3'
	};

	MonsterInsightsObject.sendEvent( type, eventName, fieldsArray );

	if (arguments.length > 3) {
	var type        = 'event';
	var eventName   = 'timing_complete';
	fieldsArray = {
	event_category : 'Scroll Depth',
	name           : action,
	event_label    : label,
	value          : timing,
	non_interaction: 1,
	send_to: 'UA-44039733-3'
	};

	MonsterInsightsObject.sendEvent( type, eventName, fieldsArray );
	}
		var paramName = action.toLowerCase();
	var fieldsArray = {
	send_to: 'G-JZP3DWZZ8W',
	non_interaction: true
	};
	fieldsArray[paramName] = label;

	if (arguments.length > 3) {
	fieldsArray.scroll_timing = timing
	MonsterInsightsObject.sendEvent('event', 'scroll_depth', fieldsArray);
	} else {
	MonsterInsightsObject.sendEvent('event', 'scroll_depth', fieldsArray);
	}
			}

		function calculateMarks(docHeight) {
		return {
		'25%' : parseInt(docHeight * 0.25, 10),
		'50%' : parseInt(docHeight * 0.50, 10),
		'75%' : parseInt(docHeight * 0.75, 10),
		/* Cushion to trigger 100% event in iOS */
		'100%': docHeight - 5
		};
		}

		function checkMarks(marks, scrollDistance, timing) {
		/* Check each active mark */
		$.each(marks, function(key, val) {
		if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
		sendEvent('Percentage', key, scrollDistance, timing);
		cache.push(key);
		}
		});
		}

		function rounded(scrollDistance) {
		/* Returns String */
		return (Math.floor(scrollDistance/250) * 250).toString();
		}

		function init() {
		bindScrollDepth();
		}

		/*
		* Public Methods
		*/

		/* Reset Scroll Depth with the originally initialized options */
		$.scrollDepth.reset = function() {
		cache = [];
		lastPixelDepth = 0;
		$window.off('scroll.scrollDepth');
		bindScrollDepth();
		};

		/* Add DOM elements to be tracked */
		$.scrollDepth.addElements = function(elems) {

		if (typeof elems == "undefined" || !$.isArray(elems)) {
		return;
		}

		$.merge(options.elements, elems);

		/* If scroll event has been unbound from window, rebind */
		if (!scrollEventBound) {
		bindScrollDepth();
		}

		};

		/* Remove DOM elements currently tracked */
		$.scrollDepth.removeElements = function(elems) {

		if (typeof elems == "undefined" || !$.isArray(elems)) {
		return;
		}

		$.each(elems, function(index, elem) {

		var inElementsArray = $.inArray(elem, options.elements);
		var inCacheArray = $.inArray(elem, cache);

		if (inElementsArray != -1) {
		options.elements.splice(inElementsArray, 1);
		}

		if (inCacheArray != -1) {
		cache.splice(inCacheArray, 1);
		}

		});

		};

		/*
		* Throttle function borrowed from:
		* Underscore.js 1.5.2
		* http://underscorejs.org
		* (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		* Underscore may be freely distributed under the MIT license.
		*/

		function throttle(func, wait) {
		var context, args, result;
		var timeout = null;
		var previous = 0;
		var later = function() {
		previous = new Date;
		timeout = null;
		result = func.apply(context, args);
		};
		return function() {
		var now = new Date;
		if (!previous) previous = now;
		var remaining = wait - (now - previous);
		context = this;
		args = arguments;
		if (remaining <= 0) {
		clearTimeout(timeout);
		timeout = null;
		previous = now;
		result = func.apply(context, args);
		} else if (!timeout) {
		timeout = setTimeout(later, remaining);
		}
		return result;
		};
		}

		/*
		* Scroll Event
		*/

		function bindScrollDepth() {

		scrollEventBound = true;

		$window.on('scroll.scrollDepth', throttle(function() {
		/*
		* We calculate document and window height on each scroll event to
		* account for dynamic DOM changes.
		*/

		var docHeight = $(document).height(),
		winHeight = window.innerHeight ? window.innerHeight : $window.height(),
		scrollDistance = $window.scrollTop() + winHeight,

		/* Recalculate percentage marks */
		marks = calculateMarks(docHeight),

		/* Timing */
		timing = +new Date - startTime;

		checkMarks(marks, scrollDistance, timing);
		}, 500));

		}

		init();
		};

		/* UMD export */
		return $.scrollDepth;

		}));

		jQuery.scrollDepth();
		} else {
		setTimeout(monsterinsights_scroll_tracking_load, 200);
		}
		}
		monsterinsights_scroll_tracking_load();
		});
		}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type="rocketlazyloadscript" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-includes/js/comment-reply.min.js?ver=6.2.2' id='comment-reply-js' defer></script>
<script type="rocketlazyloadscript" data-minify="1" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/tex-chtml.js?ver=1686601685' id='mathjax-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' id='rocket-browser-checker-js-after'>
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='rocket-preload-links-js-extra'>
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/register\/machine-learning-university\/|\/courses\/\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/|\/courses\/course-get-started\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/lessons\/why-machine-learning-does-not-have-to-be-so-hard\/|\/courses\/course-get-started\/lessons\/how-to-think-about-machine-learning\/|\/courses\/course-get-started\/lessons\/find-your-machine-learning-tribe\/|\/courses\/step-by-step-process\/|\/courses\/probability-for-machine-learning\/|\/account\/|\/register\/|\/courses\/|\/machine-learning-mastery-university-registration\/|\/register\/|\/newsletter\/|\/(?:.+\/)?feed(?:\/(?:.+\/?)?)?$|\/(?:.+\/)?embed\/|\/(index.php\/)?(.*)wp-json(\/.*|$)|\/refer\/|\/go\/|\/recommend\/|\/recommends\/|\/linkout\/.+","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' id='rocket-preload-links-js-after'>
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='advanced-ads-pro/front-js-extra'>
/* <![CDATA[ */
var advadsCfpInfo = {"cfpExpHours":"3","cfpClickLimit":"3","cfpBan":"7","cfpPath":"","cfpDomain":""};
/* ]]> */
</script>
<script data-minify="1" type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/uploads/444/337/assets/js/4.js?ver=1686601685' id='advanced-ads-pro/front-js'></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"primary","use_sticky_position":false,"margin_top":10,"margin_bottom":0,"stop_elements_selectors":"","screen_max_width":400,"screen_max_height":0,"widgets":["#custom_html-89","#custom_html-117","#custom_html-110","#custom_html-50","#custom_html-90","#custom_html-100","#custom_html-91","#custom_html-58","#custom_html-60","#custom_html-59","#custom_html-84","#custom_html-51","#custom_html-56","#custom_html-55","#custom_html-57","#custom_html-53","#custom_html-54","#custom_html-52","#custom_html-48","#custom_html-49","#custom_html-80","#custom_html-47","#custom_html-85","#custom_html-105","#custom_html-104","#custom_html-30","#custom_html-29","#custom_html-28","#custom_html-27","#custom_html-3","#custom_html-24","#custom_html-23","#custom_html-22","#custom_html-21","#custom_html-107","#custom_html-101","#custom_html-20","#custom_html-19","#custom_html-18","#custom_html-17","#custom_html-16","#custom_html-15","#custom_html-14","#custom_html-13","#custom_html-11","#custom_html-10","#custom_html-5","#custom_html-9","#custom_html-61","#custom_html-81","#custom_html-86","#custom_html-92","#custom_html-97","#custom_html-115"]}];
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/plugins/q2w3-fixed-widget/js/frontend.min.js?ver=6.2.3' id='q2w3_fixed_widget-js' defer></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='advanced-ads-pro/cache_busting-js-extra'>
/* <![CDATA[ */
var advanced_ads_pro_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","lazy_load_module_enabled":"","lazy_load":{"default_offset":0,"offsets":[]},"moveintohidden":"","wp_timezone_offset":"36000"};
/* ]]> */
</script>
<script data-minify="1" type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/uploads/444/337/assets/js/577.js?ver=1686601686' id='advanced-ads-pro/cache_busting-js'></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='advadsTrackingScript-js-extra'>
/* <![CDATA[ */
var advadsTracking = {"impressionActionName":"aatrack-records","clickActionName":"aatrack-click","targetClass":"machi-target","blogId":"1","frontendPrefix":"machi-"};
/* ]]> */
</script>
<script data-minify="1" type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/uploads/444/779/public/assets/js/755/437.js?ver=1686601686' id='advadsTrackingScript-js'></script>
<script type="73c9f148f6d44e5e000b4ea0-text/javascript" id='advadsTrackingGAFront-js-extra'>
/* <![CDATA[ */
var advadsGALocale = {"Impressions":"Impressions","Clicks":"Clicks"};
/* ]]> */
</script>
<script data-minify="1" type="73c9f148f6d44e5e000b4ea0-text/javascript" src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/uploads/444/779/public/assets/js/755/512.js?ver=1686601686' id='advadsTrackingGAFront-js'></script>
<script type="rocketlazyloadscript" data-minify="1" defer data-rocket-type='text/javascript' data-rocket-src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1686601687' id='akismet-frontend-js'></script>
<script type="rocketlazyloadscript">window.advads_admin_bar_items = [];</script><script type="73c9f148f6d44e5e000b4ea0-text/javascript">window.advads_ajax_queries = [{"id":"header","method":"placement","params":{"previous_method":"placement","previous_id":"header","post":"r0","url_parameter":"\/how-to-grid-search-hyperparameters-for-pytorch-models\/","placement_type":"default","placement_position":"center","inline-css":"","placement_conditions":{"display":{"0":{"type":"posttypes","operator":"is","value":["post"]},"1":{"type":"page_template","operator":"is_not","value":["template-archives.php","template-biz.php","template-blog.php","template-contact.php","template-imagegallery.php","template-magazine.php","template-portfolio.php","template-sitemap.php","template-timeline.php","template-widgets.php"]},"3":{"type":"request_uri","operator":"contain_not","value":"\/blog\/"},"4":{"type":"request_uri","operator":"contain_not","value":"\/category\/"}},"visitors":[{"type":"mobile","operator":"is_not"}]},"cache-busting":"auto","output":{"class":["machi-header"],"placement_id":"header"}},"elementid":"machi-effbef381c8b8c4dc105f81c84554449","blog_id":1}];
window.advads_ajax_queries_args = {"r0":{"id":14630,"author":"12","post_type":"post"}};
( window.advanced_ads_ready || jQuery( document ).ready ).call( null, function() {if ( !window.advanced_ads_pro ) {console.log("Advanced Ads Pro: cache-busting can not be initialized");} });</script><script type="rocketlazyloadscript" data-rocket-type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script><script type="73c9f148f6d44e5e000b4ea0-text/javascript">!function(){window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[],advanced_ads_ready_queue.push=window.advanced_ads_ready;for(var d=0,a=advanced_ads_ready_queue.length;d<a;d++)advanced_ads_ready(advanced_ads_ready_queue[d])}();</script><script type="73c9f148f6d44e5e000b4ea0-text/javascript">!function(){"use strict";!function(e){if(-1===e.cookie.indexOf("__adblocker")){e.cookie="__adblocker=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";var t=new XMLHttpRequest;t.open("GET","https://ads.adthrive.com/abd/abd.js",!0),t.onreadystatechange=function(){if(XMLHttpRequest.DONE===t.readyState)if(200===t.status){var a=e.createElement("script");a.innerHTML=t.responseText,e.getElementsByTagName("head")[0].appendChild(a)}else{var n=new Date;n.setTime(n.getTime()+3e5),e.cookie="__adblocker=true; expires="+n.toUTCString()+"; path=/"}},t.send()}}(document)}();
</script><script id="machi-tracking" type="73c9f148f6d44e5e000b4ea0-text/javascript">var advads_tracking_ads = {};var advads_tracking_urls = {"1":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php"};var advads_tracking_methods = {"1":"ga"};var advads_tracking_parallel = {"1":false};var advads_tracking_linkbases = {"1":"https:\/\/machinelearningmastery.com\/linkout\/"};var advads_gatracking_uids = {"1":["UA-44039733-3"]};var advads_gatracking_allads = {"1":{"14921":{"title":"mlm-t1-cmu-2302","target":"https:\/\/analytics.tepper.cmu.edu\/online-msba\/?ace_campaign=niche_display_machinelearningmasterydisplay&utm_source=machinelearningmasterydisplay&utm_medium=display&utm_campaign=machinelearningmasterydisplay","impression":true,"click":true},"13588":{"title":"Adsense 300 Backfill","target":"","impression":true,"click":true},"13572":{"title":"Test 300","target":"","impression":true,"click":true}}};var advads_gatracking_anonym = false;var advads_gatracking_transmitpageqs = {};</script><script type="rocketlazyloadscript">!function(){"use strict";var e;e=document,function(){var t,n;function r(){var t=e.createElement("script");t.src="https://cafemedia-com.videoplayerhub.com/galleryplayer.js",e.head.appendChild(t)}function a(){var t=e.cookie.match("(^|[^;]+)\\s*__adblocker\\s*=\\s*([^;]+)");return t&&t.pop()}function c(){clearInterval(n)}return{init:function(){var e;"true"===(t=a())?r():(e=0,n=setInterval((function(){100!==e&&"false"!==t||c(),"true"===t&&(r(),c()),t=a(),e++}),50))}}}().init()}();
</script><script type="73c9f148f6d44e5e000b4ea0-text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(var i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="https://machinelearningmastery.com/wp-content/plugins/wp-rocket/assets/js/lazyload/17.8.3/lazyload.min.js" type="73c9f148f6d44e5e000b4ea0-text/javascript"></script><script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="73c9f148f6d44e5e000b4ea0-|49" defer=""></script></body>
</html>
